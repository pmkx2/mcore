define(["jquery"],function(t){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){(function(){"use strict";var e,i,r,s,o,u,a,h,l;l=n(1),h=n(2),u=n(3),r=n(5),o=n(10),s=n(11),e=n(12),i=n(9),a=t.exports={util:l,route:h,config:u,Template:r,View:o,Ui:s,App:e,Stapes:i}}).call(this)},function(t,e){(function(){"use strict";var t,n,i,r;n=/^-{0,1}\d*\.{0,1}\d+$/,t="__cache_",i=window.localStorage,r={},e.isNumber=function(t){return n.test(t)},e.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)},e.clone=function(t){return JSON.parse(JSON.stringify(t))},e.cache={set:function(e,n,r){var s;return null==r&&(r=1/0),r!==1/0&&(r=(new Date).getTime()+parseInt(r)),s={time:r,value:n},i.setItem(t+e,JSON.stringify(s))},get:function(n,r){var s,o;return null==r&&(r=null),(o=i.getItem(t+n))?(o=JSON.parse(o),s=(new Date).getTime(),s<=o.time?o.value:(e.cache.remove(n),r)):r},remove:function(e){return i.removeItem(t+e)}},e.promiseCache=function(t,n,i){var r,s;return r=i.proxy.get(t),r?(s=$.Deferred(),s.resolve(e.clone(r)),s.promise()):n().then(function(n){return i.proxy.set(t,e.clone(n),i.time)})},e.promiseCacheLocalProxy={set:e.cache.set,get:e.cache.get,remove:e.cache.remove},e.promiseCacheMemoryproxy={set:function(t,e){return r[t]=e},get:function(t){return r[t]||null},remove:function(t){return delete r[t]}},e.each=function(t,e){var n,i,r;if(null==e&&(e=function(){}),!1!==Array.isArray(t))for(n in t)if(r=t[n],i=e(r,n),!1===i)break},e.format=function(t){var e,n,i,r,s,o,u,a,h,l,c;for(n=1,i=[].slice.call(arguments),o=0,u=t.length,l="",r=void 0,s=!1,e=void 0,h=void 0,a=function(){return i[n++]},c=function(){var e;for(e="";t[o].match(/\d/);)e+=t[o++];return e.length>0?parseInt(e):null};u>o;){if(r=t[o],s)switch(s=!1,h=c(),r){case"b":l+=parseInt(a(),10).toString(2);break;case"c":e=a(),l+="string"==typeof e||e instanceof String?e:String.fromCharCode(parseInt(e,10));break;case"d":l+=parseInt(a(),10);break;case"f":l+=parseFloat(a()).toFixed(h||6);break;case"o":l+="0"+parseInt(a(),10).toString(8);break;case"s":l+=a();break;case"x":l+="0x"+parseInt(a(),10).toString(16);break;case"X":l+="0x"+parseInt(a(),10).toString(16).toUpperCase();break;default:l+=r}else"%"===r?s=!0:l+=r;++o}return l}}).call(this)},function(t,e,n){(function(){"use strict";var e,i,r,s,o;o=n(1),s=function(t,e,n,i){var r;return null==e&&(e=[]),null==n&&(n=!1),null==i&&(i=!1),t instanceof RegExp?t:(r=function(t,n,i,r,s,o){return e.push({name:r,optional:!!o}),n=n||"",""+(o&&""||n)+"(?:"+(o&&n||"")+(i||"")+(s||i&&"([^/.]+?)"||"([^/]+?)")+")"+(o||"")},t=t.concat(i&&""||"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,r).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+t+"$",n&&""||"i"))},r=function(t){var e,n,i,r,s;return t=String(t),e="",i=[],-1!==t.indexOf("?")?e=t.split("?").pop():-1!==t.indexOf("&")&&(e=t),""===e?{}:(n=e.split("&"),r={},s=[],n.forEach(function(t){var e,n;-1!==t.indexOf("=")&&(t=t.split("="),2===t.length&&(e=t[0].trim(),n=t[1],n=o.isNumber(n)&&String(n).length<14?Number(n):decodeURIComponent(n),r[e]=n))}),r)},e=function(t,n,i){this.hashchange=null!=t?t:e.changeByLocationHash,this.sensitive=null!=n?n:!1,this.strict=null!=i?i:!1,this.rule=[]},e.prototype.run=function(){this.hashchange(function(t){return function(e){t.match(e)}}(this))},e.prototype.add=function(t,e){var n,i;return n=[],i=s(t,n,this.sensitive,this.strict),this.rule.push({path:t,reg:i,keys:n,fn:e}),this},e.prototype.match=function(t){var e,n,i,s,u;return u=String(t),n=u,e="",i=u.indexOf("?"),-1===i&&(i=u.indexOf("&")),s=!1,-1!==i&&(e=u.substring(i),u=u.substring(0,i)),o.each(this.rule,function(t){var i,a,h,l,c,p,f,d,v,b;if(s)return!1;if(d=t.reg.exec(u),null!==d){for(s=!0,a=r(e),h={},i=[],c=p=1,v=d.length;v>=1?v>p:p>v;c=v>=1?++p:--p)f=t.keys[c-1],b=d[c],o.isNumber(b)&&String(b).length<14?b=Number(b):b&&(b=decodeURIComponent(b)),f&&f.name&&(h[f.name]=b),i.push(b||null);l={url:n,path:u,args:e,rule:t.path,context:a,keys:t.keys,data:h},t.fn.apply(l,i)}}),this},e.changeByLocationHash=function(t){var e;return e=function(){return t(window.location.hash.substring(1))},window.addEventListener?window.addEventListener("hashchange",e,!1):window.attachEvent("onhashchange",e),e()},e.changeByHistory=function(t){var n;return window.history||e.changeByLocationHash(t),n=function(){return t(window.location.hash.substring(1))},window.onpopstate=function(t){return n()},n()},i=t.exports={pathToRegexp:s,pathToObject:r,Route:e}}).call(this)},function(t,e,n){(function(){"use strict";var e,i,r,s;e=n(4),s=n(1),i={AMDLoader:window.requirejs},r=t.exports=function(t){return!1===s.isObject(t)?i:i=e.extend(i,t)}}).call(this)},function(e,n){e.exports=t},function(t,e,n){(function(){"use strict";var e,i,r,s,o,u,a,h=[].slice;e=n(4),u=n(6),i=n(9),a=n(1),s=n(3)(),u.adapters[":"]={observe:function(t,e,n){t.on("change:"+e,n)},unobserve:function(t,e,n){t.off("change:"+e,n)},get:function(t,e){return t.get(e)},set:function(t,e,n){t.set(e,n)}},u.configure({rootInterface:".",handler:function(t,e,n){var i;return i=this.call(n.view.models.self,t,e),!1===i?e.stopPropagation&&e.preventDefault?(e.stopPropagation(),e.preventDefault()):(window.event.cancelBubble=!0,window.event.returnValue=!1):void 0}}),u.formatters.nl2br=function(t){return t?String(t).trim().replace(/<[^>]+>/g,"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br/>$2"):""},u.formatters.link=function(t,e){return t?String(t)+String(e):""},u.formatters.and=function(t,e){return t?e:t},u.formatters.or=function(t,e){return t?t:e},u.formatters.slice=function(t,e,n){return!1===Array.isArray(t)?[]:t.slice(e,n)},u.formatters.substr=function(t,e,n){return t?String(t).substring(e,n):""},u.formatters.len=function(t){return Array.isArray(t)?t.length:t?String(t).length:0},u.formatters["%"]=a.format,u.formatters.eq=function(t,e){return t===e},u.formatters["<"]=function(t,e){return Number(t)<Number(e)},u.formatters["<="]=function(t,e){return Number(t)<=Number(e)},u.formatters["=="]=function(t,e){return Number(t)===Number(e)},u.formatters[">="]=function(t,e){return Number(t)>=Number(e)},u.formatters[">"]=function(t,e){return Number(t)>Number(e)},u.formatters["+"]=function(t,e){return Number(t)+Number(e)},u.formatters["-"]=function(t,e){return Number(t)-Number(e)},u.formatters["*"]=function(t,e){return Number(t)*Number(e)},u.formatters["/"]=function(t,e){return Number(t)/Number(e)},u.formatters.isArray=function(t){return Array.isArray(t)},u.formatters.eachObject=function(t){var e,n,i,r;if(!1===a.isObject(t))return[];e=[],i=[];for(n in t)r=t[n],i.push(e.push({key:n,value:r}));return i},u.formatters.toFixed=function(t,e){return null==e&&(e=1),!1===a.isNumber(t)?0:Number(t).toFixed(e)},u.formatters["in"]=function(){var t,e;return t=1<=arguments.length?h.call(arguments,0):[],t.length<2?!1:(e=t[0],t.splice(0,1),a.isNumber(e)&&(e=Number(e)),-1!==t.indexOf(e))},r=function(t,e){this.view=t,this.data=null!=e?e:{},this.rv=!1},r.prototype.init=function(){var t,n,i,s;return t=this.data,i=Object.keys(t),n=e.Deferred(),0===i.length?(s=u.bind(this.view.$el,{self:this.view}),this.rv=s,n.resolve(s)):r.loadPromise(t).done(function(t){return function(e){i.forEach(function(n){var i;return i=e[n],null!=i?t.view.set(n,i):void 0}),s=u.bind(t.view.$el,{self:t.view}),t.rv=s,n.resolve(s)}}(this)).fail(function(){return n.reject("template render error")}),n.promise()},r.prototype.set=function(t,e){return e.then(function(e){return function(n){return e.view.set(t,n)}}(this))},r.prototype.update=function(t){var n,i;return null==t&&(t={}),n=e.Deferred(),!1===this.rv?n.reject("Template no init"):(i=Object.keys(t),r.loadPromise(t).done(function(t){return function(e){var r;r={},i.forEach(function(t){var n;return n=e[t],null!=n?r[t]=n:void 0}),t.view.set(r),n.resolve(e)}}(this)).fail(function(){return n.reject("template update error")})),n.promise()},r.prototype.destroy=function(){return this.rv?this.rv.unbind():void 0},r.loadPromise=function(t){var n,i,r;return n=e.Deferred(),i=Object.keys(t),0===i.length?n.resolve({}):(r=[],i.forEach(function(e){return function(e){return r.push(t[e])}}(this)),e.when.apply(null,r).done(function(){var t,e;return t=1<=arguments.length?h.call(arguments,0):[],e={},t.forEach(function(t){return function(t,n){var r;return r=i[n],r?(Array.isArray(t)&&3===t.length&&t[2].promise&&(t=t[0]),e[r]=t):void 0}}(this)),n.resolve(e)}).fail(function(t){return console.log(t),n.reject(t)})),n.promise()},r.loadTpl=function(t){var n,i;return n=e.Deferred(),i=String(t).split("/"),2===i.length?s.AMDLoader(["tpl/"+i[0]],function(t){var e;return e=t[i[1]],e?n.resolve(e):n.reject("url data map error")}):n.reject("uri error: "+t),n.promise()},r.bind=function(t,e){return null==t&&(t={}),e.tpl=new r(e,t),e.tpl.init().then(function(){return e.emit("render"),e.tpl})},r.renderString=function(t,e,n){var i,s,o,u;return null==e&&(e={}),u=Object.keys(e),u.length>0&&!n.tpl&&(s={},u.forEach(function(t){return function(t){return s[t]={}}}(this)),n.set(s)),i=n.$el.parent(),o=i.length>0,o&&n.$el.detach(),n.tpl?(n.emit("tplBeforeUpdate"),n.tpl.update(e).then(function(){return o&&n.$el.appendTo(i),n.emit("tplUpdate"),n.tpl})):(n.$el.append(t),n.emit("beforeRender"),r.bind(e,n).then(function(t){return o&&n.$el.appendTo(i),t}))},r.render=function(t,e,n){return null==e&&(e={}),r.loadTpl(t).then(function(t){return r.renderString(t,e,n)})},r.formatters=function(t,e){return u.formatters[t]=e},r.Attr=i.subclass({constructor:function(t,n,i){return this.name=t,this.rv=n,this.el=i,this.$el=e(this.el),this.init(this.el),this.watch()},sync:function(t){return this.rv.observer.setValue(t)},init:function(t){},update:function(t,e){},destroy:function(t){},watch:function(){}}),r.regAttr=function(t,e){var n;return n=null,u.binders[t]={bind:function(i){return n=new e(t,this,i)},unbind:function(t){return n.destroy(t)},routine:function(t,e){return n.update(e,t)}}},r.regTag=function(t,e){return null==e&&(e={}),u.components[t]={"static":e["static"]||[],attributes:e.attr||[],template:e.template||function(){return""},initialize:e.init||function(){}}},o=t.exports=r}).call(this)},function(t,e,n){var i,r;(function(t){(function(){var s,o,u,a,h=function(t,e){return function(){return t.apply(e,arguments)}},l=[].slice,c={}.hasOwnProperty,p=function(t,e){function n(){this.constructor=t}for(var i in e)c.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},f=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};s={options:["prefix","templateDelimiters","rootInterface","preloadData","handler"],extensions:["binders","formatters","components","adapters"],"public":{binders:{},components:{},formatters:{},adapters:{},prefix:"rv",templateDelimiters:["{","}"],rootInterface:".",preloadData:!0,handler:function(t,e,n){return this.call(t,e,n.view.models)},configure:function(t){var e,n,i,r;null==t&&(t={});for(i in t)if(r=t[i],"binders"===i||"components"===i||"formatters"===i||"adapters"===i)for(n in r)e=r[n],s[i][n]=e;else s["public"][i]=r},bind:function(t,e,n){var i;return null==e&&(e={}),null==n&&(n={}),i=new s.View(t,e,n),i.bind(),i},init:function(t,e,n){var i,r;return null==n&&(n={}),null==e&&(e=document.createElement("div")),t=s["public"].components[t],e.innerHTML=t.template.call(this,e),i=t.initialize.call(this,e,n),r=new s.View(e,i),r.bind(),r}}},window.jQuery||window.$?(a="on"in jQuery.prototype?["on","off"]:["bind","unbind"],o=a[0],u=a[1],s.Util={bindEvent:function(t,e,n){return jQuery(t)[o](e,n)},unbindEvent:function(t,e,n){return jQuery(t)[u](e,n)},getInputValue:function(t){var e;return e=jQuery(t),"checkbox"===e.attr("type")?e.is(":checked"):e.val()}}):s.Util={bindEvent:function(){return"addEventListener"in window?function(t,e,n){return t.addEventListener(e,n,!1)}:function(t,e,n){return t.attachEvent("on"+e,n)}}(),unbindEvent:function(){return"removeEventListener"in window?function(t,e,n){return t.removeEventListener(e,n,!1)}:function(t,e,n){return t.detachEvent("on"+e,n)}}(),getInputValue:function(t){var e,n,i,r;if("checkbox"===t.type)return t.checked;if("select-multiple"===t.type){for(r=[],n=0,i=t.length;i>n;n++)e=t[n],e.selected&&r.push(e.value);return r}return t.value}},s.TypeParser=function(){function t(){}return t.types={primitive:0,keypath:1},t.parse=function(t){return/^'.*'$|^".*"$/.test(t)?{type:this.types.primitive,value:t.slice(1,-1)}:"true"===t?{type:this.types.primitive,value:!0}:"false"===t?{type:this.types.primitive,value:!1}:"null"===t?{type:this.types.primitive,value:null}:"undefined"===t?{type:this.types.primitive,value:void 0}:isNaN(Number(t))===!1?{type:this.types.primitive,value:Number(t)}:{type:this.types.keypath,value:t}},t}(),s.TextTemplateParser=function(){function t(){}return t.types={text:0,binding:1},t.parse=function(t,e){var n,i,r,s,o,u,a;for(u=[],s=t.length,n=0,i=0;s>i;){if(n=t.indexOf(e[0],i),0>n){u.push({type:this.types.text,value:t.slice(i)});break}if(n>0&&n>i&&u.push({type:this.types.text,value:t.slice(i,n)}),i=n+e[0].length,n=t.indexOf(e[1],i),0>n){o=t.slice(i-e[1].length),r=u[u.length-1],(null!=r?r.type:void 0)===this.types.text?r.value+=o:u.push({type:this.types.text,value:o});break}a=t.slice(i,n).trim(),u.push({type:this.types.binding,value:a}),i=n+e[1].length}return u},t}(),s.View=function(){function t(t,e,n){var i,r,o,u,a,l,c,p,f,d,v,b,g;for(this.els=t,this.models=e,null==n&&(n={}),this.update=h(this.update,this),this.publish=h(this.publish,this),this.sync=h(this.sync,this),this.unbind=h(this.unbind,this),this.bind=h(this.bind,this),this.select=h(this.select,this),this.traverse=h(this.traverse,this),this.build=h(this.build,this),this.buildBinding=h(this.buildBinding,this),this.bindingRegExp=h(this.bindingRegExp,this),this.options=h(this.options,this),this.els.jquery||this.els instanceof Array||(this.els=[this.els]),f=s.extensions,a=0,c=f.length;c>a;a++){if(r=f[a],this[r]={},n[r]){d=n[r];for(i in d)o=d[i],this[r][i]=o}v=s["public"][r];for(i in v)o=v[i],null==(u=this[r])[i]&&(u[i]=o)}for(b=s.options,l=0,p=b.length;p>l;l++)r=b[l],this[r]=null!=(g=n[r])?g:s["public"][r];this.build()}return t.prototype.options=function(){var t,e,n,i,r;for(e={},r=s.extensions.concat(s.options),n=0,i=r.length;i>n;n++)t=r[n],e[t]=this[t];return e},t.prototype.bindingRegExp=function(){return new RegExp("^"+this.prefix+"-")},t.prototype.buildBinding=function(t,e,n,i){var r,o,u,a,h,l,c;return h={},c=function(){var t,e,n,r;for(n=i.split("|"),r=[],t=0,e=n.length;e>t;t++)l=n[t],r.push(l.trim());return r}(),r=function(){var t,e,n,i;for(n=c.shift().split("<"),i=[],t=0,e=n.length;e>t;t++)o=n[t],i.push(o.trim());return i}(),a=r.shift(),h.formatters=c,(u=r.shift())&&(h.dependencies=u.split(/\s+/)),this.bindings.push(new s[t](this,e,n,a,h))},t.prototype.build=function(){var t,e,n,i,r;for(this.bindings=[],e=function(t){return function(n){var i,r,o,u,a,h,l,c,p,f,d,v,b,g;if(3===n.nodeType){if(a=s.TextTemplateParser,(o=t.templateDelimiters)&&(c=a.parse(n.data,o)).length&&(1!==c.length||c[0].type!==a.types.text)){for(p=0,d=c.length;d>p;p++)l=c[p],h=document.createTextNode(l.value),n.parentNode.insertBefore(h,n),1===l.type&&t.buildBinding("TextBinding",h,null,l.value);n.parentNode.removeChild(n)}}else 1===n.nodeType&&(i=t.traverse(n));if(!i){for(b=function(){var t,e,i,r;for(i=n.childNodes,r=[],t=0,e=i.length;e>t;t++)u=i[t],r.push(u);return r}(),g=[],f=0,v=b.length;v>f;f++)r=b[f],g.push(e(r));return g}}}(this),r=this.els,n=0,i=r.length;i>n;n++)t=r[n],e(t);this.bindings.sort(function(t,e){var n,i;return((null!=(n=e.binder)?n.priority:void 0)||0)-((null!=(i=t.binder)?i.priority:void 0)||0)})},t.prototype.traverse=function(t){var e,n,i,r,o,u,a,h,l,c,p,f,d,v,b,g;for(r=this.bindingRegExp(),o="SCRIPT"===t.nodeName||"STYLE"===t.nodeName,v=t.attributes,c=0,f=v.length;f>c;c++)if(e=v[c],r.test(e.name)){if(h=e.name.replace(r,""),!(i=this.binders[h])){b=this.binders;for(u in b)l=b[u],"*"!==u&&-1!==u.indexOf("*")&&(a=new RegExp("^"+u.replace(/\*/g,".+")+"$"),a.test(h)&&(i=l))}i||(i=this.binders["*"]),i.block&&(o=!0,n=[e])}for(g=n||t.attributes,p=0,d=g.length;d>p;p++)e=g[p],r.test(e.name)&&(h=e.name.replace(r,""),this.buildBinding("Binding",t,h,e.value));return o||(h=t.nodeName.toLowerCase(),this.components[h]&&!t._bound&&(this.bindings.push(new s.ComponentBinding(this,t,h)),o=!0)),o},t.prototype.select=function(t){var e,n,i,r,s;for(r=this.bindings,s=[],n=0,i=r.length;i>n;n++)e=r[n],t(e)&&s.push(e);return s},t.prototype.bind=function(){var t,e,n,i,r;for(i=this.bindings,r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push(t.bind());return r},t.prototype.unbind=function(){var t,e,n,i,r;for(i=this.bindings,r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push(t.unbind());return r},t.prototype.sync=function(){var t,e,n,i,r;for(i=this.bindings,r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push("function"==typeof t.sync?t.sync():void 0);return r},t.prototype.publish=function(){var t,e,n,i,r;for(i=this.select(function(t){var e;return null!=(e=t.binder)?e.publishes:void 0}),r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push(t.publish());return r},t.prototype.update=function(t){var e,n,i,r,s,o,u;null==t&&(t={});for(n in t)i=t[n],this.models[n]=i;for(o=this.bindings,u=[],r=0,s=o.length;s>r;r++)e=o[r],u.push("function"==typeof e.update?e.update(t):void 0);return u},t}(),s.Binding=function(){function t(t,e,n,i,r){this.view=t,this.el=e,this.type=n,this.keypath=i,this.options=null!=r?r:{},this.getValue=h(this.getValue,this),this.update=h(this.update,this),this.unbind=h(this.unbind,this),this.bind=h(this.bind,this),this.publish=h(this.publish,this),this.sync=h(this.sync,this),this.set=h(this.set,this),this.eventHandler=h(this.eventHandler,this),this.formattedValue=h(this.formattedValue,this),this.parseTarget=h(this.parseTarget,this),this.observe=h(this.observe,this),this.setBinder=h(this.setBinder,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.formatterObservers={},this.model=void 0,this.setBinder()}return t.prototype.setBinder=function(){var t,e,n,i;if(!(this.binder=this.view.binders[this.type])){i=this.view.binders;for(t in i)n=i[t],"*"!==t&&-1!==t.indexOf("*")&&(e=new RegExp("^"+t.replace(/\*/g,".+")+"$"),e.test(this.type)&&(this.binder=n,this.args=new RegExp("^"+t.replace(/\*/g,"(.+)")+"$").exec(this.type),this.args.shift()))}return this.binder||(this.binder=this.view.binders["*"]),this.binder instanceof Function?this.binder={routine:this.binder}:void 0},t.prototype.observe=function(t,e,n){return s.sightglass(t,e,n,{root:this.view.rootInterface,adapters:this.view.adapters})},t.prototype.parseTarget=function(){var t;return t=s.TypeParser.parse(this.keypath),0===t.type?this.value=t.value:(this.observer=this.observe(this.view.models,this.keypath,this.sync),this.model=this.observer.target)},t.prototype.formattedValue=function(t){var e,n,i,r,o,u,a,h,c,p,f,d,v,b;for(b=this.formatters,r=p=0,d=b.length;d>p;r=++p){for(o=b[r],i=o.match(/[^\s']+|'([^']|'[^\s])*'|"([^"]|"[^\s])*"/g),u=i.shift(),o=this.view.formatters[u],i=function(){var t,e,r;for(r=[],t=0,e=i.length;e>t;t++)n=i[t],r.push(s.TypeParser.parse(n));return r}(),h=[],e=f=0,v=i.length;v>f;e=++f)n=i[e],h.push(0===n.type?n.value:((c=this.formatterObservers)[r]||(c[r]={}),(a=this.formatterObservers[r][e])?void 0:(a=this.observe(this.view.models,n.value,this.sync),this.formatterObservers[r][e]=a),a.value()));(null!=o?o.read:void 0)instanceof Function?t=o.read.apply(o,[t].concat(l.call(h))):o instanceof Function&&(t=o.apply(null,[t].concat(l.call(h))))}return t},t.prototype.eventHandler=function(t){var e,n;return n=(e=this).view.handler,function(i){return n.call(t,this,i,e)}},t.prototype.set=function(t){var e;return t=t instanceof Function&&!this.binder["function"]?this.formattedValue(t.call(this.model)):this.formattedValue(t),null!=(e=this.binder.routine)?e.call(this,this.el,t):void 0},t.prototype.sync=function(){var t,e;return this.set(function(){var n,i,r,s,o,u,a;if(this.observer){if(this.model!==this.observer.target){for(o=this.dependencies,n=0,r=o.length;r>n;n++)e=o[n],e.unobserve();if(this.dependencies=[],null!=(this.model=this.observer.target)&&(null!=(u=this.options.dependencies)?u.length:void 0))for(a=this.options.dependencies,i=0,s=a.length;s>i;i++)t=a[i],e=this.observe(this.model,t,this.sync),this.dependencies.push(e)}return this.observer.value()}return this.value}.call(this))},t.prototype.publish=function(){var t,e,n,i,r,s,o,u,a;if(this.observer){for(i=this.getValue(this.el),o=this.formatters.slice(0).reverse(),r=0,s=o.length;s>r;r++)e=o[r],t=e.split(/\s+/),n=t.shift(),(null!=(u=this.view.formatters[n])?u.publish:void 0)&&(i=(a=this.view.formatters[n]).publish.apply(a,[i].concat(l.call(t))));return this.observer.setValue(i)}},t.prototype.bind=function(){var t,e,n,i,r,s,o;if(this.parseTarget(),null!=(r=this.binder.bind)&&r.call(this,this.el),null!=this.model&&(null!=(s=this.options.dependencies)?s.length:void 0))for(o=this.options.dependencies,n=0,i=o.length;i>n;n++)t=o[n],e=this.observe(this.model,t,this.sync),this.dependencies.push(e);return this.view.preloadData?this.sync():void 0},t.prototype.unbind=function(){var t,e,n,i,r,s,o,u,a,h;for(null!=(o=this.binder.unbind)&&o.call(this,this.el),null!=(u=this.observer)&&u.unobserve(),a=this.dependencies,r=0,s=a.length;s>r;r++)i=a[r],i.unobserve();this.dependencies=[],h=this.formatterObservers;for(n in h){e=h[n];for(t in e)i=e[t],i.unobserve()}return this.formatterObservers={}},t.prototype.update=function(t){var e,n;return null==t&&(t={}),this.model=null!=(e=this.observer)?e.target:void 0,null!=(n=this.binder.update)?n.call(this,t):void 0},t.prototype.getValue=function(t){return this.binder&&null!=this.binder.getValue?this.binder.getValue.call(this,t):s.Util.getInputValue(t)},t}(),s.ComponentBinding=function(t){function e(t,e,n){var i,r,s,o,u,a,l;for(this.view=t,this.el=e,this.type=n,this.unbind=h(this.unbind,this),this.bind=h(this.bind,this),this.locals=h(this.locals,this),this.component=this.view.components[this.type],this["static"]={},this.observers={},this.upstreamObservers={},r=t.bindingRegExp(),a=this.el.attributes||[],o=0,u=a.length;u>o;o++)i=a[o],r.test(i.name)||(s=this.camelCase(i.name),f.call(null!=(l=this.component["static"])?l:[],s)>=0?this["static"][s]=i.value:this.observers[s]=i.value)}return p(e,t),e.prototype.sync=function(){},e.prototype.update=function(){},e.prototype.publish=function(){},e.prototype.locals=function(){var t,e,n,i,r,s;n={},r=this["static"];for(t in r)i=r[t],n[t]=i;s=this.observers;for(t in s)e=s[t],n[t]=e.value();return n},e.prototype.camelCase=function(t){return t.replace(/-([a-z])/g,function(t){return t[1].toUpperCase()})},e.prototype.bind=function(){var t,e,n,i,r,o,u,a,h,l,c,p,f,d,v,b,g,m,y,w,x;if(!this.bound){d=this.observers;for(e in d)n=d[e],this.observers[e]=this.observe(this.view.models,n,function(t){return function(e){return function(){return t.componentView.models[e]=t.observers[e].value()}}}(this).call(this,e));this.bound=!0}if(null!=this.componentView)return this.componentView.bind();for(this.el.innerHTML=this.component.template.call(this),u=this.component.initialize.call(this,this.el,this.locals()),this.el._bound=!0,o={},v=s.extensions,l=0,p=v.length;p>l;l++){if(r=v[l],o[r]={},this.component[r]){b=this.component[r];for(t in b)a=b[t],o[r][t]=a}g=this.view[r];for(t in g)a=g[t],null==(h=o[r])[t]&&(h[t]=a)}for(m=s.options,c=0,f=m.length;f>c;c++)r=m[c],o[r]=null!=(y=this.component[r])?y:this.view[r];this.componentView=new s.View(this.el,u,o),this.componentView.bind(),w=this.observers,x=[];for(e in w)i=w[e],x.push(this.upstreamObservers[e]=this.observe(this.componentView.models,e,function(t){return function(e,n){return function(){return n.setValue(t.componentView.models[e])}}}(this).call(this,e,i)));return x},e.prototype.unbind=function(){var t,e,n,i,r;n=this.upstreamObservers;for(t in n)e=n[t],e.unobserve();i=this.observers;for(t in i)e=i[t],e.unobserve();return null!=(r=this.componentView)?r.unbind.call(this):void 0},e}(s.Binding),s.TextBinding=function(t){function e(t,e,n,i,r){this.view=t,this.el=e,this.type=n,this.keypath=i,this.options=null!=r?r:{},this.sync=h(this.sync,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.formatterObservers={}}return p(e,t),e.prototype.binder={routine:function(t,e){return t.data=null!=e?e:""}},e.prototype.sync=function(){return e.__super__.sync.apply(this,arguments)},e}(s.Binding),s["public"].binders.text=function(t,e){return null!=t.textContent?t.textContent=null!=e?e:"":t.innerText=null!=e?e:""},s["public"].binders.html=function(t,e){return t.innerHTML=null!=e?e:""},s["public"].binders.show=function(t,e){return t.style.display=e?"":"none"},s["public"].binders.hide=function(t,e){return t.style.display=e?"none":""},s["public"].binders.enabled=function(t,e){return t.disabled=!e},s["public"].binders.disabled=function(t,e){return t.disabled=!!e},s["public"].binders.checked={publishes:!0,priority:2e3,bind:function(t){return s.Util.bindEvent(t,"change",this.publish)},unbind:function(t){return s.Util.unbindEvent(t,"change",this.publish)},routine:function(t,e){var n;return"radio"===t.type?t.checked=(null!=(n=t.value)?n.toString():void 0)===(null!=e?e.toString():void 0):t.checked=!!e}},s["public"].binders.unchecked={publishes:!0,priority:2e3,bind:function(t){return s.Util.bindEvent(t,"change",this.publish)},unbind:function(t){return s.Util.unbindEvent(t,"change",this.publish)},routine:function(t,e){var n;return"radio"===t.type?t.checked=(null!=(n=t.value)?n.toString():void 0)!==(null!=e?e.toString():void 0):t.checked=!e}},s["public"].binders.value={publishes:!0,priority:3e3,bind:function(t){return"INPUT"!==t.tagName||"radio"!==t.type?(this.event="SELECT"===t.tagName?"change":"input",s.Util.bindEvent(t,this.event,this.publish)):void 0},unbind:function(t){return"INPUT"!==t.tagName||"radio"!==t.type?s.Util.unbindEvent(t,this.event,this.publish):void 0},routine:function(t,e){var n,i,r,s,o,u,a;if("INPUT"===t.tagName&&"radio"===t.type)return t.setAttribute("value",e);if(null!=window.jQuery){if(t=jQuery(t),(null!=e?e.toString():void 0)!==(null!=(s=t.val())?s.toString():void 0))return t.val(null!=e?e:"")}else if("select-multiple"===t.type){if(null!=e){for(a=[],i=0,r=t.length;r>i;i++)n=t[i],a.push(n.selected=(o=n.value,f.call(e,o)>=0));return a}}else if((null!=e?e.toString():void 0)!==(null!=(u=t.value)?u.toString():void 0))return t.value=null!=e?e:""}},s["public"].binders["if"]={block:!0,priority:4e3,bind:function(t){var e,n;return null==this.marker?(e=[this.view.prefix,this.type].join("-").replace("--","-"),n=t.getAttribute(e),this.marker=document.createComment(" rivets: "+this.type+" "+n+" "),this.bound=!1,t.removeAttribute(e),t.parentNode.insertBefore(this.marker,t),t.parentNode.removeChild(t)):void 0},unbind:function(){var t;return null!=(t=this.nested)?t.unbind():void 0},routine:function(t,e){var n,i,r,o;if(!!e==!this.bound){if(e){r={},o=this.view.models;for(n in o)i=o[n],r[n]=i;return(this.nested||(this.nested=new s.View(t,r,this.view.options()))).bind(),this.marker.parentNode.insertBefore(t,this.marker.nextSibling),this.bound=!0}return t.parentNode.removeChild(t),this.nested.unbind(),this.bound=!1}},update:function(t){var e;return null!=(e=this.nested)?e.update(t):void 0}},s["public"].binders.unless={block:!0,priority:4e3,bind:function(t){return s["public"].binders["if"].bind.call(this,t)},unbind:function(){return s["public"].binders["if"].unbind.call(this)},routine:function(t,e){return s["public"].binders["if"].routine.call(this,t,!e)},update:function(t){return s["public"].binders["if"].update.call(this,t)}},s["public"].binders["on-*"]={"function":!0,priority:1e3,unbind:function(t){return this.handler?s.Util.unbindEvent(t,this.args[0],this.handler):void 0},routine:function(t,e){return this.handler&&s.Util.unbindEvent(t,this.args[0],this.handler),s.Util.bindEvent(t,this.args[0],this.handler=this.eventHandler(e))}},s["public"].binders["each-*"]={block:!0,priority:4e3,bind:function(t){var e,n,i,r,s;if(null==this.marker)e=[this.view.prefix,this.type].join("-").replace("--","-"),this.marker=document.createComment(" rivets: "+this.type+" "),this.iterated=[],t.removeAttribute(e),t.parentNode.insertBefore(this.marker,t),t.parentNode.removeChild(t);else for(s=this.iterated,i=0,r=s.length;r>i;i++)n=s[i],n.bind()},unbind:function(t){var e,n,i,r,s;if(null!=this.iterated){for(r=this.iterated,s=[],n=0,i=r.length;i>n;n++)e=r[n],s.push(e.unbind());return s}},routine:function(t,e){var n,i,r,o,u,a,h,l,c,p,f,d,v,b,g,m,y,w,x,k,V;if(h=this.args[0],e=e||[],this.iterated.length>e.length)for(w=Array(this.iterated.length-e.length),d=0,g=w.length;g>d;d++)r=w[d],f=this.iterated.pop(),f.unbind(),this.marker.parentNode.removeChild(f.els[0]);for(o=v=0,m=e.length;m>v;o=++v)if(a=e[o],i={index:o},i[h]=a,null==this.iterated[o]){x=this.view.models;for(u in x)a=x[u],null==i[u]&&(i[u]=a);c=this.iterated.length?this.iterated[this.iterated.length-1].els[0]:this.marker,l=this.view.options(),l.preloadData=!0,p=t.cloneNode(!0),f=new s.View(p,i,l),f.bind(),this.iterated.push(f),this.marker.parentNode.insertBefore(p,c.nextSibling)}else this.iterated[o].models[h]!==a&&this.iterated[o].update(i);if("OPTION"===t.nodeName){for(k=this.view.bindings,V=[],b=0,y=k.length;y>b;b++)n=k[b],n.el===this.marker.parentNode&&"value"===n.type?V.push(n.sync()):V.push(void 0);return V}},update:function(t){var e,n,i,r,s,o,u,a;e={};for(n in t)i=t[n],n!==this.args[0]&&(e[n]=i);for(u=this.iterated,a=[],s=0,o=u.length;o>s;s++)r=u[s],a.push(r.update(e));return a}},s["public"].binders["class-*"]=function(t,e){var n;return n=" "+t.className+" ",!e==(-1!==n.indexOf(" "+this.args[0]+" "))?t.className=e?""+t.className+" "+this.args[0]:n.replace(" "+this.args[0]+" "," ").trim():void 0},s["public"].binders["*"]=function(t,e){return null!=e?t.setAttribute(this.type,e):t.removeAttribute(this.type)},s["public"].adapters["."]={id:"_rv",counter:0,weakmap:{},weakReference:function(t){var e,n,i;return t.hasOwnProperty(this.id)||(e=this.counter++,Object.defineProperty(t,this.id,{value:e})),(n=this.weakmap)[i=t[this.id]]||(n[i]={callbacks:{}})},cleanupWeakReference:function(t,e){return Object.keys(t.callbacks).length||t.pointers&&Object.keys(t.pointers).length?void 0:delete this.weakmap[e]},stubFunction:function(t,e){var n,i,r;return i=t[e],n=this.weakReference(t),r=this.weakmap,t[e]=function(){var e,s,o,u,a,h,l,c,p,f;u=i.apply(t,arguments),l=n.pointers;for(o in l)for(s=l[o],f=null!=(c=null!=(p=r[o])?p.callbacks[s]:void 0)?c:[],a=0,h=f.length;h>a;a++)(e=f[a])();return u}},observeMutations:function(t,e,n){var i,r,s,o,u,a;if(Array.isArray(t)){if(s=this.weakReference(t),null==s.pointers)for(s.pointers={},r=["push","pop","shift","unshift","sort","reverse","splice"],u=0,a=r.length;a>u;u++)i=r[u],this.stubFunction(t,i);if(null==(o=s.pointers)[e]&&(o[e]=[]),f.call(s.pointers[e],n)<0)return s.pointers[e].push(n)}},unobserveMutations:function(t,e,n){var i,r,s;return Array.isArray(t)&&null!=t[this.id]&&(r=this.weakmap[t[this.id]])&&(s=r.pointers[e])?((i=s.indexOf(n))>=0&&s.splice(i,1),s.length||delete r.pointers[e],this.cleanupWeakReference(r,t[this.id])):void 0},observe:function(t,e,n){var i,r,s;return i=this.weakReference(t).callbacks,null==i[e]&&(i[e]=[],r=Object.getOwnPropertyDescriptor(t,e),(null!=r?r.get:void 0)||(null!=r?r.set:void 0)||(s=t[e],Object.defineProperty(t,e,{enumerable:!0,get:function(){return s},set:function(r){return function(o){var u,a,h,l;if(o!==s&&(r.unobserveMutations(s,t[r.id],e),s=o,u=r.weakmap[t[r.id]])){if(i=u.callbacks,i[e])for(l=i[e].slice(),a=0,h=l.length;h>a;a++)n=l[a],f.call(i[e],n)>=0&&n();return r.observeMutations(o,t[r.id],e)}}}(this)}))),f.call(i[e],n)<0&&i[e].push(n),this.observeMutations(t[e],t[this.id],e)},unobserve:function(t,e,n){var i,r,s;return(s=this.weakmap[t[this.id]])&&(i=s.callbacks[e])?((r=i.indexOf(n))>=0&&(i.splice(r,1),i.length||delete s.callbacks[e]),this.unobserveMutations(t[e],t[this.id],e),
this.cleanupWeakReference(s,t[this.id])):void 0},get:function(t,e){return t[e]},set:function(t,e,n){return t[e]=n}},s.factory=function(t){return s.sightglass=t,s["public"]._=s,s["public"]},"object"==typeof("undefined"!=typeof t&&null!==t?t.exports:void 0)?t.exports=s.factory(n(8)):(i=[n(8)],r=function(t){return this.rivets=s.factory(t)}.apply(e,i),!(void 0!==r&&(t.exports=r)))}).call(this)}).call(e,n(7)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e,n){var i,r;(function(){function n(t,e,n,i){return new s(t,e,n,i)}function s(t,e,n,i){this.options=i||{},this.options.adapters=this.options.adapters||{},this.obj=t,this.keypath=e,this.callback=n,this.objectPath=[],this.parse(),o(this.target=this.realize())&&this.set(!0,this.key,this.target,this.callback)}function o(t){return"object"==typeof t&&null!==t}function u(t){throw new Error("[sightglass] "+t)}n.adapters={},s.tokenize=function(t,e,n){var i,r,s=[],o={i:n,path:""};for(i=0;i<t.length;i++)r=t.charAt(i),~e.indexOf(r)?(s.push(o),o={i:r,path:""}):o.path+=r;return s.push(o),s},s.prototype.parse=function(){var t,e,i=this.interfaces();i.length||u("Must define at least one adapter interface."),~i.indexOf(this.keypath[0])?(t=this.keypath[0],e=this.keypath.substr(1)):("undefined"==typeof(t=this.options.root||n.root)&&u("Must define a default root adapter."),e=this.keypath),this.tokens=s.tokenize(e,i,t),this.key=this.tokens.pop()},s.prototype.realize=function(){var t,e=this.obj,n=!1;return this.tokens.forEach(function(i,r){o(e)?("undefined"!=typeof this.objectPath[r]?e!==(t=this.objectPath[r])&&(this.set(!1,i,t,this.update.bind(this)),this.set(!0,i,e,this.update.bind(this)),this.objectPath[r]=e):(this.set(!0,i,e,this.update.bind(this)),this.objectPath[r]=e),e=this.get(i,e)):(n===!1&&(n=r),(t=this.objectPath[r])&&this.set(!1,i,t,this.update.bind(this)))},this),n!==!1&&this.objectPath.splice(n),e},s.prototype.update=function(){var t,e;(t=this.realize())!==this.target&&(o(this.target)&&this.set(!1,this.key,this.target,this.callback),o(t)&&this.set(!0,this.key,t,this.callback),e=this.value(),this.target=t,this.value()!==e&&this.callback())},s.prototype.value=function(){return o(this.target)?this.get(this.key,this.target):void 0},s.prototype.setValue=function(t){o(this.target)&&this.adapter(this.key).set(this.target,this.key.path,t)},s.prototype.get=function(t,e){return this.adapter(t).get(e,t.path)},s.prototype.set=function(t,e,n,i){var r=t?"observe":"unobserve";this.adapter(e)[r](n,e.path,i)},s.prototype.interfaces=function(){var t=Object.keys(this.options.adapters);return Object.keys(n.adapters).forEach(function(e){~t.indexOf(e)||t.push(e)}),t},s.prototype.adapter=function(t){return this.options.adapters[t.i]||n.adapters[t.i]},s.prototype.unobserve=function(){var t;this.tokens.forEach(function(e,n){(t=this.objectPath[n])&&this.set(!1,e,t,this.update.bind(this))},this),o(this.target)&&this.set(!1,this.key,this.target,this.callback)},"undefined"!=typeof t&&t.exports?t.exports=n:(i=[],r=function(){return this.sightglass=n}.apply(e,i),!(void 0!==r&&(t.exports=r)))}).call(this)},function(t,e,n){!function(){"use strict";var n="0.8.1",i=1;if(!Object.create)var r=function(){};var s=Array.prototype.slice,o={attributes:{},eventHandlers:{"-1":{}},guid:-1,addEvent:function(t){o.eventHandlers[t.guid][t.type]||(o.eventHandlers[t.guid][t.type]=[]),o.eventHandlers[t.guid][t.type].push({guid:t.guid,handler:t.handler,scope:t.scope,type:t.type})},addEventHandler:function(t,e,n){var i,r={};"string"==typeof t?(i=n||!1,r[t]=e):(i=e||!1,r=t);for(var s in r)for(var u=r[s],a=s.split(" "),h=0,l=a.length;l>h;h++){var c=a[h];o.addEvent.call(this,{guid:this._guid||this._.guid,handler:u,scope:i,type:c})}},addGuid:function(t,e){(!t._guid||e)&&(t._guid=i++,o.attributes[t._guid]={},o.eventHandlers[t._guid]={})},attr:function(t){return o.attributes[t]},clone:function(t){var e=o.typeOf(t);return"object"===e?o.extend({},t):"array"===e?t.slice(0):void 0},create:function(t){return Object.create?Object.create(t):(r.prototype=t,new r)},createSubclass:function(t,e){function n(){if(!(this instanceof n))throw new Error("Please use 'new' when initializing Stapes classes");this.on&&o.addGuid(this,!0),r.apply(this,arguments)}t=t||{},e=e||!1;var i=t.superclass.prototype,r=t.hasOwnProperty("constructor")?t.constructor:function(){};e&&o.extend(i,u),n.prototype=o.create(i),n.prototype.constructor=n,o.extend(n,{extend:function(){return o.extendThis.apply(this,arguments)},parent:i,proto:function(){return o.extendThis.apply(this.prototype,arguments)},subclass:function(t){return t=t||{},t.superclass=this,o.createSubclass(t)}});for(var s in t)"constructor"!==s&&"superclass"!==s&&(n.prototype[s]=t[s]);return n},emitEvents:function(t,e,n,i){n=n||!1,i=i||this._guid;for(var r=s.call(o.eventHandlers[i][t]),u=0,a=r.length;a>u;u++){var h=o.extend({},r[u]),l=h.scope?h.scope:this;n&&(h.type=n),h.scope=l,h.handler.call(h.scope,e,h)}},extend:function(){for(var t=s.call(arguments),e=t.shift(),n=0,i=t.length;i>n;n++){var r=t[n];for(var o in r)e[o]=r[o]}return e},extendThis:function(){var t=s.call(arguments);return t.unshift(this),o.extend.apply(this,t)},makeUuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})},removeAttribute:function(t,e){e=e||!1;for(var n=o.trim(t).split(" "),i={},r=0,s=n.length;s>r;r++){var u=o.trim(n[r]);u&&(i.key=u,i.oldValue=o.attr(this._guid)[u],delete o.attr(this._guid)[u],e||(this.emit("change",u),this.emit("change:"+u),this.emit("mutate",i),this.emit("mutate:"+u,i),this.emit("remove",u),this.emit("remove:"+u)),delete i.oldValue)}},removeEventHandler:function(t,e){var n=o.eventHandlers[this._guid];if(t&&e){if(n=n[t],!n)return;for(var i,r=0,s=n.length;s>r;r++)i=n[r].handler,i&&i===e&&(n.splice(r--,1),s--)}else t?delete n[t]:o.eventHandlers[this._guid]={}},setAttribute:function(t,e,n){n=n||!1;var i=this.has(t),r=o.attr(this._guid)[t];if(e!==r&&(o.attr(this._guid)[t]=e,!n)){this.emit("change",t),this.emit("change:"+t,e);var s={key:t,newValue:e,oldValue:r||null};this.emit("mutate",s),this.emit("mutate:"+t,s);var u=i?"update":"create";this.emit(u,t),this.emit(u+":"+t,e)}},trim:function(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},typeOf:function(t){return null===t||"undefined"==typeof t?String(t):Object.prototype.toString.call(t).replace(/\[object |\]/g,"").toLowerCase()},updateAttribute:function(t,e,n){var i=this.get(t),r=o.typeOf(i);("object"===r||"array"===r)&&(i=o.clone(i));var s=e.call(this,i,t);o.setAttribute.call(this,t,s,n||!1)}},u={emit:function(t,e){e="undefined"==typeof e?null:e;for(var n=t.split(" "),i=0,r=n.length;r>i;i++){var s=n[i];o.eventHandlers[-1].all&&o.emitEvents.call(this,"all",e,s,-1),o.eventHandlers[-1][s]&&o.emitEvents.call(this,s,e,s,-1),"number"==typeof this._guid&&(o.eventHandlers[this._guid].all&&o.emitEvents.call(this,"all",e,s),o.eventHandlers[this._guid][s]&&o.emitEvents.call(this,s,e))}},off:function(){o.removeEventHandler.apply(this,arguments)},on:function(){o.addEventHandler.apply(this,arguments)}};o.Module=function(){},o.Module.prototype={each:function(t,e){var n=o.attr(this._guid);for(var i in n){var r=n[i];t.call(e||this,r,i)}},extend:function(){return o.extendThis.apply(this,arguments)},filter:function(t){var e=[],n=o.attr(this._guid);for(var i in n)t.call(this,n[i],i)&&e.push(n[i]);return e},get:function(t){if("string"==typeof t){if(arguments.length>1){for(var e={},n=0,i=arguments.length;i>n;n++){var r=arguments[n];e[r]=this.get(r)}return e}return this.has(t)?o.attr(this._guid)[t]:null}if("function"==typeof t){var s=this.filter(t);return s.length?s[0]:null}},getAll:function(){return o.clone(o.attr(this._guid))},getAllAsArray:function(){var t=[],e=o.attr(this._guid);for(var n in e){var i=e[n];"object"!==o.typeOf(i)||i.id||(i.id=n),t.push(i)}return t},has:function(t){return"undefined"!=typeof o.attr(this._guid)[t]},map:function(t,e){var n=[];return this.each(function(i,r){n.push(t.call(e||this,i,r))},e||this),n},push:function(t,e){if("array"===o.typeOf(t))for(var n=0,i=t.length;i>n;n++)o.setAttribute.call(this,o.makeUuid(),t[n],e||!1);else o.setAttribute.call(this,o.makeUuid(),t,e||!1);return this},remove:function(t,e){return"undefined"==typeof t?(o.attributes[this._guid]={},this.emit("change remove")):"function"==typeof t?this.each(function(n,i){t(n)&&o.removeAttribute.call(this,i,e)}):o.removeAttribute.call(this,t,e||!1),this},set:function(t,e,n){if("object"==typeof t)for(var i in t)o.setAttribute.call(this,i,t[i],e||!1);else o.setAttribute.call(this,t,e,n||!1);return this},size:function(){var t=0,e=o.attr(this._guid);for(var n in e)t++;return t},update:function(t,e,n){return"string"==typeof t?o.updateAttribute.call(this,t,e,n||!1):"function"==typeof t&&this.each(function(e,n){o.updateAttribute.call(this,n,t)}),this}};var a={_:o,extend:function(){return o.extendThis.apply(o.Module.prototype,arguments)},mixinEvents:function(t){return t=t||{},o.addGuid(t),o.extend(t,u)},on:function(){o.addEventHandler.apply(this,arguments)},subclass:function(t,e){return e=e||!1,t=t||{},t.superclass=e?function(){}:o.Module,o.createSubclass(t,!e)},version:n};"undefined"!=typeof t&&t.exports&&(e=t.exports=a),e.Stapes=a}()},function(t,e,n){(function(){"use strict";var e,i,r,s,o,u,a,h,l;e=n(4),o=n(5),s=n(9),l=n(1),r=e(window),i=e("body"),a=/MicroMessenger/i.test(window.navigator.userAgent),u=/iphone|ipad/gi.test(window.navigator.appVersion),h=t.exports=s.subclass({constructor:function(t,e){return this.$el=t,this.app=e,this.$win=r,this.$body=i,this.util=l,this._cacheMap={},this.isWeixinBrowser=a,this.isIOS=u,this.tpl=!1,this.beforeInit(),this.init(),this.watch()},clone:function(t){return l.clone(t)},asyncSet:function(t,e){return e.then(function(e){return function(n){return e.set(t,n),n}}(this))},setTitle:function(t){var n;return this.title=t,document.title!==this.title?(document.title=this.title,this.isWeixinBrowser&&this.isIOS?(n=e('<iframe src="/favicon.ico"></iframe>'),n.one("load",function(){return setTimeout(function(){return n.remove()},0)}).appendTo(this.$body)):void 0):void 0},render:function(t,e){return null==e&&(e={}),o.render(t,e,this)},renderString:function(t,e){return null==e&&(e={}),o.renderString(t,e,this)},bind:function(t){return null==t&&(t={}),o.bind(t,this)},when:function(){return e.when.apply(this,arguments)},destroy:function(){return this.tpl&&this.tpl.destroy(),this.$el.remove()},memoryCache:function(t){var e,n;return n=l.promiseCacheMemoryproxy,e={has:function(e){return l.promiseCache(t,e,{proxy:n})},remove:function(){return n.remove(t)}}},localCache:function(t){var e,n;return n=l.promiseCacheLocalProxy,e={has:function(e,i){return null==i&&(i=1/0),l.promiseCache(t,e,{proxy:n,time:i})},remove:function(){return n.remove(t)}}},sessionCach:function(t){var e,n;return n=this.promiseCacheSessionProxy(),e={has:function(e){return l.promiseCache(t,e,{proxy:n})},remove:function(){return n.remove(t)}}},promiseCacheSessionProxy:function(){var t;return t={set:function(t){return function(e,n){return t._cacheMap[e]=n}}(this),get:function(t){return function(e){return t._cacheMap[e]||null}}(this)}},back:function(){return window.history.length>1?window.history.back():window.location.href="#",!1},beforeInit:function(){},init:function(){},run:function(){},afterRun:function(){},watch:function(){}})}).call(this)},function(t,e,n){(function(){"use strict";var e,i,r,s,o;e=n(4),s=n(5),r=n(9),i=e("body"),o=t.exports=r.subclass({constructor:function(t,n){return this.options=null!=n?n:{},this.$el=e("<div/>"),this.$parent=t||i,this.on("render",function(t){return function(){return t.$el.appendTo(t.$parent)}}(this)),this.init(),this.watch()},destroy:function(){return this.tpl&&this.tpl.destroy(),this.$el.remove()},render:function(t,e){return null==e&&(e={}),s.render(t,e,this)},renderString:function(t,e){return null==e&&(e={}),s.renderString(t,e,this)},init:function(){},watch:function(){}})}).call(this)},function(t,e,n){(function(){"use strict";var e,i,r,s,o;e=n(4),i=n(9),o=n(2),r=n(3)(),s=t.exports=i.subclass({constructor:function(t,n){this.$el=t,null==n&&(n={}),this.options=e.extend({viewClass:"mcore-app-view",routeChange:o.Route.changeByLocationHash},n),this.router=new o.Route(this.options.routeChange),this.curView=null,this._onLoadViw=!1,this._middlewares=[]},route:function(t,e){var n;return n=this,this.router.add(t,function(){return n.runView(e,this,arguments)}),this},use:function(t){return this._middlewares.push(t),this},_runView:function(t){return null==t&&(t=function(){}),this.curView.instantiate.route=this.env.route,this.curView.instantiate.context=this.env.context,this.curView.instantiate.run.apply(this.curView.instantiate,this.env.args),this.emit("runView",this.curView),t(this.curView.instantiate)},stack:function(t,e,n){var i,r,s;return null==t&&(t=0),null==e&&(e=null),null==n&&(n=function(){}),t===this._middlewares.length?this._runView(n):(i=this._middlewares[t],s=t+1,r=function(t){return function(e){return t.stack(s,e,n)}}(this),this.env.view=this.curView.instantiate,i.call(this.env,e,r))},runMiddlewares:function(t){return null==t&&(t=function(){}),0===this._middlewares.length?this._runView(t):this.stack(0,null,t)},runView:function(t,n,i){if(!this._onLoadViw){if(this.env={route:n,context:n.context,args:i,viewName:t,app:this},this.curView){if(this.curView.name===t)return void this.runMiddlewares(function(t){return function(){return t.curView.instantiate.afterRun()}}(this));this.emit("destroyView",this.curView),this.curView.instantiate.destroy(),this.curView=null}return this._onLoadViw=!0,r.AMDLoader([t],function(n){return function(i){var r;return r=e("<div class='"+n.options.viewClass+"' />"),n.curView={name:t,instantiate:new i(r,n)},n.runMiddlewares(function(){return n.curView.instantiate.$el.appendTo(n.$el),n.curView.instantiate.afterRun(),n._onLoadViw=!1})}}(this))}},run:function(){return this.router.run()}})}).call(this)}])});