define(["jquery","mcore"],function(e,t){return function(e){function t(o){if(i[o])return i[o].exports;var n=i[o]={exports:{},id:o,loaded:!1};return e[o].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){(function(){"use strict";var t,o,n;n=i(13),o=i(14),i(16),o.ext={validator:n},t=e.exports=o}).call(this)},,,,function(t,i){t.exports=e},,,,,,,,,function(e,t,i){(function(){"use strict";var t,o,n,r,l,a,s,c,_,u,h,f,p,m,g=[].slice;t=i(4),f=i(14),i(15),o=f.Template,r=/^[A-Za-z]+$/,a=/^(?:[a-z0-9]+[_\-+.]+)*[a-z0-9]+@(?:([a-z0-9]+-?)*[a-z0-9]+.)+([a-z]{2,})+$/i,l=/^([1-2]\d{3})([-\/.])?(1[0-2]|0?[1-9])([-\/.])?([1-2]\d|3[01]|0?[1-9])$/,c=/^1[3-9]\d{9}$/,_=/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/,s=/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i,m=function(){var e,t,i,o,n,r,l,a,s,c;return l="((https?|s?ftp|irc[6s]?|git|afp|telnet|smb):\\/\\/)?",c="([a-z0-9]\\w*(\\:[\\S]+)?\\@)?",t="(?:localhost|(?:[a-z0-9]+(?:[-\\w]*[a-z0-9])?(?:\\.[a-z0-9][-\\w]*[a-z0-9])*)*\\.[a-z]{2,})",r="(:\\d{1,5})?",o="\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}",e="(\\/\\S*)?",i=[l,c,t,r,e],n=[l,c,o,r,e],a=new RegExp("^"+i.join("")+"$","i"),s=new RegExp("^"+n.join("")+"$","i"),function(e){return a.test(e||s.test(e))}}(),u={required:"不能为空",isNumber:"只能是数字",isAlphabet:"只能是字母",minlength:function(e){return"最小 "+e+" 位字符"},maxlength:function(e){return"最多 "+e+" 位字符"},min:function(e){return"数值要大于 "+e},max:function(e){return"数值要小于 "+e},equals:"两次输入的值不相符",isEmail:"邮箱格式不正确",isInteger:"数值必须是整数",isDate:"日期格式不正确",isMobile:"手机格式不正确",isTel:"座机格式不正确",isIdentityCode:"身份证号格式错误"},p={required:function(e){return null==e&&(e=""),String(e).trim().length>0},isAlphabet:function(e){return r.test(e)},minlength:function(e,t){return t=Number(t),e=String(e).trim(),e.length>=t},maxlength:function(e,t){return t=Number(t),e=String(e).trim(),e.length<t},isNumber:function(e){return t.isNumeric(e)},isInteger:function(e){return Number(e)%1===0},min:function(e,t){return Number(e)>=Number(t)},max:function(e,t){return Number(e)<=Number(t)},equals:function(e,i){return i instanceof t&&(i=i.val()),e instanceof t&&(e=e.val()),String(e)===String(i)},isEmail:function(e){return a.test(e)},isDate:function(e){var t,i,o,n,r;return l.test(e)?!1:(n=l.exec(e),r=Number(n[1]),o=Number(n[3]-1),i=Number(n[5]),t=new Date(r,o,i),r===t.getFullYear()&&o===t.getMonth()&&i===t.getDate())},isMobile:function(e){return c.test(e)},isTel:function(e){return _.test(e)},isIdentityCode:function(e){var t,i,o,n,r,l,a,c,_,u;if(i={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"},s.test(e))return!1;if(!i[e.substr(0,2)])return!1;if(18===e.length){for(o=e.split(""),n=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],c=[1,0,"X",9,8,7,6,5,4,3,2],_=0,t=0,u=0,r=l=0;17>l;r=++l)t=o[r],u=n[r],_+=t*u;if(a=c[_%11],a!==o[17])return!1}return!0},isUrl:function(e){return m(e)}},n=o.Attr.subclass({constructor:o.Attr.prototype.constructor,init:function(){return this.$el.is("form")===!1?!1:this.$el.data("check",function(e){return function(){return e.initRules(),e.check()}}(this))},update:function(e){return this.$el.is("form")?void 0:e?this.$el.attr("validator",e):this.$el.removeAttr("validator")},check:function(){var e,i,o,n;return n=!0,i=this.$el.serializeObject(),o=null,e=this.$el,t.each(this.rules,function(t,r){var l;if("required"===r.type||""!==i[r.name]&&void 0!==i[r.name])return l=r.args[0],r.args[0]=i[r.name],!1===r.rule.apply(null,r.args)?(o=function(){return{$el:l,err:r.err,$form:e}},n=!1,!1):void 0}),n&&i||o},initRules:function(){var e;return e=this,this.rules=[],this.$validators=this.$el.find("[validator]"),this.$validators.each(function(){return e.parseValidator(t(this))})},parseValidator:function(e){var i;return(i=e.attr("name"))?e.attr("validator").split("|").forEach(function(o){return function(n){var r,l,a,s,c,_;return r=n.split(" ").filter(function(e){return t.trim(e).length>0}),_=r[0],(l=p[_])?(c=String(r[r.length-1]).trim(),a=u[_]||"出错了",s=c.indexOf("err:"),0===s&&(a=c.substring(4)),t.isFunction(a)&&(a=a.apply(null,r.slice(1))),r[0]=e,"equals"===_&&(r[1]=o.$el.find(r[1]).eq(0)),o.rules.push({name:i,type:_,rule:l,args:r,err:a})):void console.log("validator rule: "+_+" undefined")}}(this)):void 0}}),o.regAttr("validator",n),h=e.exports={add:function(e,t){return p[e]=t},check:function(){var e,t;return e=1<=arguments.length?g.call(arguments,0):[],e.length<2?!1:(t=e[0],e.splice(0,1),p[t]?p[t].apply(null,e):!1)},addErrMsg:function(e,t){return u[e]=t},ValidatorAttr:n}}).call(this)},function(e,i){e.exports=t},function(e,t,i){"use strict";var o=i(4),n=function(e){function t(t,o){function n(e,t,i){return e[t]=i,e}function r(e,t){for(var o,r=e.match(i.key);void 0!==(o=r.pop());)if(i.push.test(o)){var a=l(e.replace(/\[\]$/,""));t=n([],a,t)}else i.fixed.test(o)?t=n([],o,t):i.named.test(o)&&(t=n({},o,t));return t}function l(e){return void 0===f[e]&&(f[e]=0),f[e]++}function a(t){switch(e('[name="'+t.name+'"]',o).attr("type")){case"checkbox":return"on"===t.value?!0:t.value;default:return t.value}}function s(e){if(!i.validate.test(e.name))return this;var o=r(e.name,a(e));return h=t.extend(!0,h,o),this}function c(e){if(!t.isArray(e))throw new Error("formSerializer.addPairs expects an Array");for(var i=0,o=e.length;o>i;i++)this.addPair(e[i]);return this}function _(){return h}function u(){return JSON.stringify(_())}var h={},f={};this.addPair=s,this.addPairs=c,this.serialize=_,this.serializeJSON=u}var i={validate:/^[a-z_][a-z0-9_]*(?:\[(?:\d*|[a-z0-9_]+)\])*$/i,key:/[a-z0-9_]+|(?=\[\])/gi,push:/^$/,fixed:/^\d+$/,named:/^[a-z0-9_]+$/i};return t.patterns=i,t.serializeObject=function(){return new t(e,this).addPairs(this.serializeArray()).serialize()},t.serializeJSON=function(){return new t(e,this).addPairs(this.serializeArray()).serializeJSON()},"undefined"!=typeof e.fn&&(e.fn.serializeObject=t.serializeObject,e.fn.serializeJSON=t.serializeJSON),t}(o);t=e.exports=n},function(e,t,i){(function(){"use strict";var e,t,o,n,r,l,a,s,c,_,u,h,f,p,m;e=i(4),f=i(17),_=i(14),n=_.Template,o=e(window),t=e(document),l=document.documentElement.style,l.hasOwnProperty("WebkitAppearance")?a="webkit":l.hasOwnProperty("MozAppearance")?a="gecko":"string"==typeof navigator.cpuClass?a="trident":window.opera&&"[object Opera]"===Object.prototype.toString.call(opera)&&(a="presto"),m={webkit:"Webkit",trident:"ms",gecko:"Moz",presto:"O"}[a],s=document.createElement("div"),u=m+"Perspective",p=m+"Transform",h=function(e){return s.style.hasOwnProperty(u)?function(t,i,o){e.style[p]="translate3d("+-t+"px, "+-i+"px,0) scale("+o+")"}:s.style.hasOwnProperty(p)?function(t,i,o){e.style[p]="translate("+-t+"px, "+-i+"px,0) scale("+o+")"}:function(t,i,o){e.style.marginLeft=t&&-t/o+"px"||"",e.style.marginTop=i&&-i/o+"px"||"",e.style.zoom=o||""}},r=0,c=function(e,t){var i;return null==t&&(t=function(){}),e?(i=new Image,i.onload=t,i.onerror=t,i.src=e):t()},n.regAttr("scroller",n.Attr.subclass({constructor:n.Attr.prototype.constructor,init:function(){return r++,this.id=r,this.scrollingY="yes"===this.$el.attr("data-scrolling-y"),this.scrollingX="yes"===this.$el.attr("data-scrolling-x"),this.scrollingX===this.scrollingY&&this.scrollingX===!1&&(this.scrollingY=!0),this.height=Number(this.$el.attr("data-scrolling-height")||0),this.width=Number(this.$el.attr("data-scrolling-width")||0),this.loadImgTime=!1,this.$el.wrap('<div class="scroller-wrap"></div>'),this.$container=this.$el.parent().css({overflow:"hidden",position:"relative"}),this.$el.css({position:"absolute"}),this.scrollingX===!1&&this.$el.css({width:"100%"}),this.scroller=new f.Scroller(h(this.$el[0]),{scrollingX:this.scrollingX,scrollingY:this.scrollingY,zooming:!1,locking:!1}),this.$el.data("scroller",this.scroller),this.soureSize={width:0,height:0},this.size={width:0,height:0},this.resize()},update:function(t,i){var o,n,r;return this.$el=e(i),this.resize(),o=this.$el.find("img"),n=o.length,n>0?(this.loadImgTime&&clearTimeout(this.loadImgTime),r=0,this.loadImgTime=setTimeout(function(e){return function(){var t;return t=e,o.each(function(){return c(this.src,function(){return r++,r===n?t.resize():void 0})})}}(this),300)):void 0},destroy:function(){return this.$el.remove(),o.off("touchmove.scroller"+this.id).off("touchend.scroller"+this.id).off("mousemove.scroller"+this.id).off("mouseup.scroller"+this.id).off("resize.scroller"+this.id)},getSoureHeight:function(){var t;return t=0,this.$el.children().each(function(){return t+=e(this).outerHeight()}),t},getSoureWidth:function(){var t;return t=0,this.$el.children().each(function(){return t+=e(this).outerWidth()}),t},watch:function(){var e,t,i,n;return e=this.$container[0],i=!1,n=!1,t=!1,this.on("touchend",function(e){return function(t){var i,o;return i=t.e,o=t.vals,o.top+e.size.height>e.soureSize.height?e.$el.trigger("scrollend",i,e):o.top<20?e.$el.trigger("scrollstart",i,e):void 0}}(this)),e.addEventListener("touchstart",function(e){return function(i){return t=!0,i.target.tagName.match(/input|textarea|select/i)?void 0:(n=!0,e.scroller.doTouchStart(i.touches,i.timeStamp),!1)}}(this),!1),o.on("touchmove.scroller"+this.id,function(e){return function(t){var i;return i=t.originalEvent,e.scroller.doTouchMove(i.touches,i.timeStamp,i.scale||1),n?i.preventDefault():void 0}}(this)),o.on("touchend.scroller"+this.id,function(e){return function(i){var o;t=!0,n=!1,o=i.originalEvent,e.scroller.doTouchEnd(o.timeStamp),e.emit("touchend",{e:o,vals:e.scroller.getValues()})}}(this)),e.addEventListener("mousedown",function(e){return function(o){return t||o.target.tagName.match(/input|textarea|select/i)?void 0:(e.scroller.doTouchStart([{pageX:o.pageX,pageY:o.pageY}],o.timeStamp),i=!0)}}(this),!1),o.on("mousemove.scroller"+this.id,function(e){return function(o){var n;if(!t&&(n=o.originalEvent,!1!==i))return e.scroller.doTouchStart([{pageX:n.pageX,pageY:n.pageY}],n.timeStamp),i=!0,n.preventDefault()}}(this)),o.on("mouseup.scroller"+this.id,function(e){return function(o){var n;if(!t&&(n=o.originalEvent,!1!==i))return e.scroller.doTouchEnd(n.timeStamp),e.emit("touchend",{e:n,vals:e.scroller.getValues()}),i=!1}}(this)),o.on("resize.scroller"+this.id,function(e){return function(){return e.resize()}}(this))},resize:function(){return window.requestAnimationFrame?window.requestAnimationFrame(function(e){return function(){return e._resize()}}(this)):this._resize()},_resize:function(){var e,t,i,n,r,l,a,s;return t=this.$container[0],i=this.$el[0],r=t.getBoundingClientRect(),this.scroller.setPosition(r.left+t.clientLeft,r.top+t.clientTop),s=this.width||t.clientWidth,n=this.height||t.clientHeight,a=i.offsetWidth,l=i.offsetHeight,this.scrollingY&&0===this.height&&(n=o.outerHeight()-r.top),this.scrollingY&&n>l&&(l=this.getSoureHeight(),n>l&&(l=n+80)),this.scrollingX&&0===this.width&&(e=this.getSoureWidth()+4,e>a&&(a=e),n=l),this.$container.css({width:s||"100%",height:n||"100%"}),this.soureSize={width:a,height:l},this.size={width:this.$container.width(),height:this.$container.height()},this.scrollingY&&(l+=40),this.scroller.setDimensions(s,n,a,l)}}))}).call(this)},function(e,t){"use strict";!function(e){var t=Date.now||function(){return+new Date},i=60,o=1e3,n={},r=1;e.core?core.effect||(core.effect={}):e.core={effect:{}},core.effect.Animate={requestAnimationFrame:function(){var t=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame,i=!!t;if(t&&!/requestAnimationFrame\(\)\s*\{\s*\[native code\]\s*\}/i.test(t.toString())&&(i=!1),i)return function(e,i){t(e,i)};var o=60,n={},r=0,l=1,a=null,s=+new Date;return function(e,t){var i=l++;return n[i]=e,r++,null===a&&(a=setInterval(function(){var e=+new Date,t=n;n={},r=0;for(var i in t)t.hasOwnProperty(i)&&(t[i](e),s=e);e-s>2500&&(clearInterval(a),a=null)},1e3/o)),i}}(),stop:function(e){var t=null!=n[e];return t&&(n[e]=null),t},isRunning:function(e){return null!=n[e]},start:function(e,l,a,s,c,_){var u=t(),h=u,f=0,p=0,m=r++;if(_||(_=document.body),m%20===0){var g={};for(var d in n)g[d]=!0;n=g}var v=function(r){var g=r!==!0,d=t();if(!n[m]||l&&!l(m))return n[m]=null,void(a&&a(i-p/((d-u)/o),m,!1));if(g)for(var T=Math.round((d-h)/(o/i))-1,S=0;S<Math.min(T,4);S++)v(!0),p++;s&&(f=(d-u)/s,f>1&&(f=1));var z=c?c(f):f;e(z,d,g)!==!1&&1!==f||!g?g&&(h=d,core.effect.Animate.requestAnimationFrame(v,_)):(n[m]=null,a&&a(i-p/((d-u)/o),m,1===f||null==s))};return n[m]=!0,core.effect.Animate.requestAnimationFrame(v,_),m}}}(window);var i;!function(){var e=function(){};i=function(t,i){this.__callback=t,this.options={scrollingX:!0,scrollingY:!0,animating:!0,animationDuration:250,bouncing:!0,locking:!0,paging:!1,snapping:!1,zooming:!1,minZoom:.5,maxZoom:3,speedMultiplier:1,scrollingComplete:e,penetrationDeceleration:.03,penetrationAcceleration:.08};for(var o in i)this.options[o]=i[o]};var t=function(e){return Math.pow(e-1,3)+1},o=function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},n={__isSingleTouch:!1,__isTracking:!1,__didDecelerationComplete:!1,__isGesturing:!1,__isDragging:!1,__isDecelerating:!1,__isAnimating:!1,__clientLeft:0,__clientTop:0,__clientWidth:0,__clientHeight:0,__contentWidth:0,__contentHeight:0,__snapWidth:100,__snapHeight:100,__refreshHeight:null,__refreshActive:!1,__refreshActivate:null,__refreshDeactivate:null,__refreshStart:null,__zoomLevel:1,__scrollLeft:0,__scrollTop:0,__maxScrollLeft:0,__maxScrollTop:0,__scheduledLeft:0,__scheduledTop:0,__scheduledZoom:0,__lastTouchLeft:null,__lastTouchTop:null,__lastTouchMove:null,__positions:null,__minDecelerationScrollLeft:null,__minDecelerationScrollTop:null,__maxDecelerationScrollLeft:null,__maxDecelerationScrollTop:null,__decelerationVelocityX:null,__decelerationVelocityY:null,setDimensions:function(e,t,i,o){var n=this;e===+e&&(n.__clientWidth=e),t===+t&&(n.__clientHeight=t),i===+i&&(n.__contentWidth=i),o===+o&&(n.__contentHeight=o),n.__computeScrollMax(),n.scrollTo(n.__scrollLeft,n.__scrollTop,!0)},setPosition:function(e,t){var i=this;i.__clientLeft=e||0,i.__clientTop=t||0},setSnapSize:function(e,t){var i=this;i.__snapWidth=e,i.__snapHeight=t},activatePullToRefresh:function(e,t,i,o){var n=this;n.__refreshHeight=e,n.__refreshActivate=t,n.__refreshDeactivate=i,n.__refreshStart=o},triggerPullToRefresh:function(){this.__publish(this.__scrollLeft,-this.__refreshHeight,this.__zoomLevel,!0),this.__refreshStart&&this.__refreshStart()},finishPullToRefresh:function(){var e=this;e.__refreshActive=!1,e.__refreshDeactivate&&e.__refreshDeactivate(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0)},getValues:function(){var e=this;return{left:e.__scrollLeft,top:e.__scrollTop,zoom:e.__zoomLevel}},getScrollMax:function(){var e=this;return{left:e.__maxScrollLeft,top:e.__maxScrollTop}},zoomTo:function(e,t,i,o,n){var r=this;if(!r.options.zooming)throw new Error("Zooming is not enabled!");n&&(r.__zoomComplete=n),r.__isDecelerating&&(core.effect.Animate.stop(r.__isDecelerating),r.__isDecelerating=!1);var l=r.__zoomLevel;null==i&&(i=r.__clientWidth/2),null==o&&(o=r.__clientHeight/2),e=Math.max(Math.min(e,r.options.maxZoom),r.options.minZoom),r.__computeScrollMax(e);var a=(i+r.__scrollLeft)*e/l-i,s=(o+r.__scrollTop)*e/l-o;a>r.__maxScrollLeft?a=r.__maxScrollLeft:0>a&&(a=0),s>r.__maxScrollTop?s=r.__maxScrollTop:0>s&&(s=0),r.__publish(a,s,e,t)},zoomBy:function(e,t,i,o,n){var r=this;r.zoomTo(r.__zoomLevel*e,t,i,o,n)},scrollTo:function(e,t,i,o){var n=this;if(n.__isDecelerating&&(core.effect.Animate.stop(n.__isDecelerating),n.__isDecelerating=!1),null!=o&&o!==n.__zoomLevel){if(!n.options.zooming)throw new Error("Zooming is not enabled!");e*=o,t*=o,n.__computeScrollMax(o)}else o=n.__zoomLevel;n.options.scrollingX?n.options.paging?e=Math.round(e/n.__clientWidth)*n.__clientWidth:n.options.snapping&&(e=Math.round(e/n.__snapWidth)*n.__snapWidth):e=n.__scrollLeft,n.options.scrollingY?n.options.paging?t=Math.round(t/n.__clientHeight)*n.__clientHeight:n.options.snapping&&(t=Math.round(t/n.__snapHeight)*n.__snapHeight):t=n.__scrollTop,e=Math.max(Math.min(n.__maxScrollLeft,e),0),t=Math.max(Math.min(n.__maxScrollTop,t),0),e===n.__scrollLeft&&t===n.__scrollTop&&(i=!1),n.__publish(e,t,o,i)},scrollBy:function(e,t,i){var o=this,n=o.__isAnimating?o.__scheduledLeft:o.__scrollLeft,r=o.__isAnimating?o.__scheduledTop:o.__scrollTop;o.scrollTo(n+(e||0),r+(t||0),i)},doMouseZoom:function(e,t,i,o){var n=this,r=e>0?.97:1.03;return n.zoomTo(n.__zoomLevel*r,!1,i-n.__clientLeft,o-n.__clientTop)},doTouchStart:function(e,t){if(null==e.length)throw new Error("Invalid touch list: "+e);if(t instanceof Date&&(t=t.valueOf()),"number"!=typeof t)throw new Error("Invalid timestamp value: "+t);var i=this;i.__interruptedAnimation=!0,i.__isDecelerating&&(core.effect.Animate.stop(i.__isDecelerating),i.__isDecelerating=!1,i.__interruptedAnimation=!0),i.__isAnimating&&(core.effect.Animate.stop(i.__isAnimating),i.__isAnimating=!1,i.__interruptedAnimation=!0);var o,n,r=1===e.length;r?(o=e[0].pageX,n=e[0].pageY):(o=Math.abs(e[0].pageX+e[1].pageX)/2,n=Math.abs(e[0].pageY+e[1].pageY)/2),i.__initialTouchLeft=o,i.__initialTouchTop=n,i.__zoomLevelStart=i.__zoomLevel,i.__lastTouchLeft=o,i.__lastTouchTop=n,i.__lastTouchMove=t,i.__lastScale=1,i.__enableScrollX=!r&&i.options.scrollingX,i.__enableScrollY=!r&&i.options.scrollingY,i.__isTracking=!0,i.__didDecelerationComplete=!1,i.__isDragging=!r,i.__isSingleTouch=r,i.__positions=[]},doTouchMove:function(e,t,i){if(null==e.length)throw new Error("Invalid touch list: "+e);if(t instanceof Date&&(t=t.valueOf()),"number"!=typeof t)throw new Error("Invalid timestamp value: "+t);var o=this;if(o.__isTracking){var n,r;2===e.length?(n=Math.abs(e[0].pageX+e[1].pageX)/2,r=Math.abs(e[0].pageY+e[1].pageY)/2):(n=e[0].pageX,r=e[0].pageY);var l=o.__positions;if(o.__isDragging){var a=n-o.__lastTouchLeft,s=r-o.__lastTouchTop,c=o.__scrollLeft,_=o.__scrollTop,u=o.__zoomLevel;if(null!=i&&o.options.zooming){var h=u;if(u=u/o.__lastScale*i,u=Math.max(Math.min(u,o.options.maxZoom),o.options.minZoom),h!==u){var f=n-o.__clientLeft,p=r-o.__clientTop;c=(f+c)*u/h-f,_=(p+_)*u/h-p,o.__computeScrollMax(u)}}if(o.__enableScrollX){c-=a*this.options.speedMultiplier;var m=o.__maxScrollLeft;(c>m||0>c)&&(o.options.bouncing?c+=a/2*this.options.speedMultiplier:c=c>m?m:0)}if(o.__enableScrollY){_-=s*this.options.speedMultiplier;var g=o.__maxScrollTop;(_>g||0>_)&&(o.options.bouncing?(_+=s/2*this.options.speedMultiplier,o.__enableScrollX||null==o.__refreshHeight||(!o.__refreshActive&&_<=-o.__refreshHeight?(o.__refreshActive=!0,o.__refreshActivate&&o.__refreshActivate()):o.__refreshActive&&_>-o.__refreshHeight&&(o.__refreshActive=!1,o.__refreshDeactivate&&o.__refreshDeactivate()))):_=_>g?g:0)}l.length>60&&l.splice(0,30),l.push(c,_,t),o.__publish(c,_,u)}else{var d=o.options.locking?3:0,v=5,T=Math.abs(n-o.__initialTouchLeft),S=Math.abs(r-o.__initialTouchTop);o.__enableScrollX=o.options.scrollingX&&T>=d,o.__enableScrollY=o.options.scrollingY&&S>=d,l.push(o.__scrollLeft,o.__scrollTop,t),o.__isDragging=(o.__enableScrollX||o.__enableScrollY)&&(T>=v||S>=v),o.__isDragging&&(o.__interruptedAnimation=!1)}o.__lastTouchLeft=n,o.__lastTouchTop=r,o.__lastTouchMove=t,o.__lastScale=i}},doTouchEnd:function(e){if(e instanceof Date&&(e=e.valueOf()),"number"!=typeof e)throw new Error("Invalid timestamp value: "+e);var t=this;if(t.__isTracking){if(t.__isTracking=!1,t.__isDragging)if(t.__isDragging=!1,t.__isSingleTouch&&t.options.animating&&e-t.__lastTouchMove<=100){for(var i=t.__positions,o=i.length-1,n=o,r=o;r>0&&i[r]>t.__lastTouchMove-100;r-=3)n=r;if(n!==o){var l=i[o]-i[n],a=t.__scrollLeft-i[n-2],s=t.__scrollTop-i[n-1];t.__decelerationVelocityX=a/l*(1e3/60),t.__decelerationVelocityY=s/l*(1e3/60);var c=t.options.paging||t.options.snapping?4:1;(Math.abs(t.__decelerationVelocityX)>c||Math.abs(t.__decelerationVelocityY)>c)&&(t.__refreshActive||t.__startDeceleration(e))}else t.options.scrollingComplete()}else e-t.__lastTouchMove>100&&t.options.scrollingComplete();t.__isDecelerating||(t.__refreshActive&&t.__refreshStart?(t.__publish(t.__scrollLeft,-t.__refreshHeight,t.__zoomLevel,!0),t.__refreshStart&&t.__refreshStart()):((t.__interruptedAnimation||t.__isDragging)&&t.options.scrollingComplete(),t.scrollTo(t.__scrollLeft,t.__scrollTop,!0,t.__zoomLevel),t.__refreshActive&&(t.__refreshActive=!1,t.__refreshDeactivate&&t.__refreshDeactivate()))),t.__positions.length=0}},__publish:function(e,i,n,r){var l=this,a=l.__isAnimating;if(a&&(core.effect.Animate.stop(a),l.__isAnimating=!1),r&&l.options.animating){l.__scheduledLeft=e,l.__scheduledTop=i,l.__scheduledZoom=n;var s=l.__scrollLeft,c=l.__scrollTop,_=l.__zoomLevel,u=e-s,h=i-c,f=n-_,p=function(e,t,i){i&&(l.__scrollLeft=s+u*e,l.__scrollTop=c+h*e,l.__zoomLevel=_+f*e,l.__callback&&l.__callback(l.__scrollLeft,l.__scrollTop,l.__zoomLevel))},m=function(e){return l.__isAnimating===e},g=function(e,t,i){t===l.__isAnimating&&(l.__isAnimating=!1),(l.__didDecelerationComplete||i)&&l.options.scrollingComplete(),l.options.zooming&&(l.__computeScrollMax(),l.__zoomComplete&&(l.__zoomComplete(),l.__zoomComplete=null))};l.__isAnimating=core.effect.Animate.start(p,m,g,l.options.animationDuration,a?t:o)}else l.__scheduledLeft=l.__scrollLeft=e,l.__scheduledTop=l.__scrollTop=i,l.__scheduledZoom=l.__zoomLevel=n,l.__callback&&l.__callback(e,i,n),l.options.zooming&&(l.__computeScrollMax(),l.__zoomComplete&&(l.__zoomComplete(),l.__zoomComplete=null))},__computeScrollMax:function(e){var t=this;null==e&&(e=t.__zoomLevel),t.__maxScrollLeft=Math.max(t.__contentWidth*e-t.__clientWidth,0),t.__maxScrollTop=Math.max(t.__contentHeight*e-t.__clientHeight,0)},__startDeceleration:function(e){var t=this;if(t.options.paging){var i=Math.max(Math.min(t.__scrollLeft,t.__maxScrollLeft),0),o=Math.max(Math.min(t.__scrollTop,t.__maxScrollTop),0),n=t.__clientWidth,r=t.__clientHeight;t.__minDecelerationScrollLeft=Math.floor(i/n)*n,t.__minDecelerationScrollTop=Math.floor(o/r)*r,t.__maxDecelerationScrollLeft=Math.ceil(i/n)*n,t.__maxDecelerationScrollTop=Math.ceil(o/r)*r}else t.__minDecelerationScrollLeft=0,t.__minDecelerationScrollTop=0,t.__maxDecelerationScrollLeft=t.__maxScrollLeft,t.__maxDecelerationScrollTop=t.__maxScrollTop;var l=function(e,i,o){t.__stepThroughDeceleration(o)},a=t.options.snapping?4:.1,s=function(){var e=Math.abs(t.__decelerationVelocityX)>=a||Math.abs(t.__decelerationVelocityY)>=a;return e||(t.__didDecelerationComplete=!0),e},c=function(e,i,o){t.__isDecelerating=!1,t.__didDecelerationComplete&&t.options.scrollingComplete(),t.scrollTo(t.__scrollLeft,t.__scrollTop,t.options.snapping)};t.__isDecelerating=core.effect.Animate.start(l,s,c)},__stepThroughDeceleration:function(e){var t=this,i=t.__scrollLeft+t.__decelerationVelocityX,o=t.__scrollTop+t.__decelerationVelocityY;if(!t.options.bouncing){var n=Math.max(Math.min(t.__maxDecelerationScrollLeft,i),t.__minDecelerationScrollLeft);n!==i&&(i=n,t.__decelerationVelocityX=0);var r=Math.max(Math.min(t.__maxDecelerationScrollTop,o),t.__minDecelerationScrollTop);r!==o&&(o=r,t.__decelerationVelocityY=0)}if(e?t.__publish(i,o,t.__zoomLevel):(t.__scrollLeft=i,t.__scrollTop=o),!t.options.paging){var l=.95;t.__decelerationVelocityX*=l,t.__decelerationVelocityY*=l}if(t.options.bouncing){var a=0,s=0,c=t.options.penetrationDeceleration,_=t.options.penetrationAcceleration;i<t.__minDecelerationScrollLeft?a=t.__minDecelerationScrollLeft-i:i>t.__maxDecelerationScrollLeft&&(a=t.__maxDecelerationScrollLeft-i),o<t.__minDecelerationScrollTop?s=t.__minDecelerationScrollTop-o:o>t.__maxDecelerationScrollTop&&(s=t.__maxDecelerationScrollTop-o),0!==a&&(a*t.__decelerationVelocityX<=0?t.__decelerationVelocityX+=a*c:t.__decelerationVelocityX=a*_),0!==s&&(s*t.__decelerationVelocityY<=0?t.__decelerationVelocityY+=s*c:t.__decelerationVelocityY=s*_)}}};for(var r in n)i.prototype[r]=n[r]}(),t=e.exports={Scroller:i}}])});