!function(){"use strict";var t="0.8.1",e=1;if(!Object.create)var n=function(){};var i=Array.prototype.slice,r={attributes:{},eventHandlers:{"-1":{}},guid:-1,addEvent:function(t){r.eventHandlers[t.guid][t.type]||(r.eventHandlers[t.guid][t.type]=[]),r.eventHandlers[t.guid][t.type].push({guid:t.guid,handler:t.handler,scope:t.scope,type:t.type})},addEventHandler:function(t,e,n){var i,s={};"string"==typeof t?(i=n||!1,s[t]=e):(i=e||!1,s=t);for(var o in s)for(var u=s[o],a=o.split(" "),h=0,l=a.length;l>h;h++){var c=a[h];r.addEvent.call(this,{guid:this._guid||this._.guid,handler:u,scope:i,type:c})}},addGuid:function(t,n){(!t._guid||n)&&(t._guid=e++,r.attributes[t._guid]={},r.eventHandlers[t._guid]={})},attr:function(t){return r.attributes[t]},clone:function(t){var e=r.typeOf(t);return"object"===e?r.extend({},t):"array"===e?t.slice(0):void 0},create:function(t){return Object.create?Object.create(t):(n.prototype=t,new n)},createSubclass:function(t,e){function n(){if(!(this instanceof n))throw new Error("Please use 'new' when initializing Stapes classes");this.on&&r.addGuid(this,!0),o.apply(this,arguments)}t=t||{},e=e||!1;var i=t.superclass.prototype,o=t.hasOwnProperty("constructor")?t.constructor:function(){};e&&r.extend(i,s),n.prototype=r.create(i),n.prototype.constructor=n,r.extend(n,{extend:function(){return r.extendThis.apply(this,arguments)},parent:i,proto:function(){return r.extendThis.apply(this.prototype,arguments)},subclass:function(t){return t=t||{},t.superclass=this,r.createSubclass(t)}});for(var u in t)"constructor"!==u&&"superclass"!==u&&(n.prototype[u]=t[u]);return n},emitEvents:function(t,e,n,s){n=n||!1,s=s||this._guid;for(var o=i.call(r.eventHandlers[s][t]),u=0,a=o.length;a>u;u++){var h=r.extend({},o[u]),l=h.scope?h.scope:this;n&&(h.type=n),h.scope=l,h.handler.call(h.scope,e,h)}},extend:function(){for(var t=i.call(arguments),e=t.shift(),n=0,r=t.length;r>n;n++){var s=t[n];for(var o in s)e[o]=s[o]}return e},extendThis:function(){var t=i.call(arguments);return t.unshift(this),r.extend.apply(this,t)},makeUuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})},removeAttribute:function(t,e){e=e||!1;for(var n=r.trim(t).split(" "),i={},s=0,o=n.length;o>s;s++){var u=r.trim(n[s]);u&&(i.key=u,i.oldValue=r.attr(this._guid)[u],delete r.attr(this._guid)[u],e||(this.emit("change",u),this.emit("change:"+u),this.emit("mutate",i),this.emit("mutate:"+u,i),this.emit("remove",u),this.emit("remove:"+u)),delete i.oldValue)}},removeEventHandler:function(t,e){var n=r.eventHandlers[this._guid];if(t&&e){if(n=n[t],!n)return;for(var i,s=0,o=n.length;o>s;s++)i=n[s].handler,i&&i===e&&(n.splice(s--,1),o--)}else t?delete n[t]:r.eventHandlers[this._guid]={}},setAttribute:function(t,e,n){n=n||!1;var i=this.has(t),s=r.attr(this._guid)[t];if(e!==s&&(r.attr(this._guid)[t]=e,!n)){this.emit("change",t),this.emit("change:"+t,e);var o={key:t,newValue:e,oldValue:s||null};this.emit("mutate",o),this.emit("mutate:"+t,o);var u=i?"update":"create";this.emit(u,t),this.emit(u+":"+t,e)}},trim:function(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},typeOf:function(t){return null===t||"undefined"==typeof t?String(t):Object.prototype.toString.call(t).replace(/\[object |\]/g,"").toLowerCase()},updateAttribute:function(t,e,n){var i=this.get(t),s=r.typeOf(i);("object"===s||"array"===s)&&(i=r.clone(i));var o=e.call(this,i,t);r.setAttribute.call(this,t,o,n||!1)}},s={emit:function(t,e){e="undefined"==typeof e?null:e;for(var n=t.split(" "),i=0,s=n.length;s>i;i++){var o=n[i];r.eventHandlers[-1].all&&r.emitEvents.call(this,"all",e,o,-1),r.eventHandlers[-1][o]&&r.emitEvents.call(this,o,e,o,-1),"number"==typeof this._guid&&(r.eventHandlers[this._guid].all&&r.emitEvents.call(this,"all",e,o),r.eventHandlers[this._guid][o]&&r.emitEvents.call(this,o,e))}},off:function(){r.removeEventHandler.apply(this,arguments)},on:function(){r.addEventHandler.apply(this,arguments)}};r.Module=function(){},r.Module.prototype={each:function(t,e){var n=r.attr(this._guid);for(var i in n){var s=n[i];t.call(e||this,s,i)}},extend:function(){return r.extendThis.apply(this,arguments)},filter:function(t){var e=[],n=r.attr(this._guid);for(var i in n)t.call(this,n[i],i)&&e.push(n[i]);return e},get:function(t){if("string"==typeof t){if(arguments.length>1){for(var e={},n=0,i=arguments.length;i>n;n++){var s=arguments[n];e[s]=this.get(s)}return e}return this.has(t)?r.attr(this._guid)[t]:null}if("function"==typeof t){var o=this.filter(t);return o.length?o[0]:null}},getAll:function(){return r.clone(r.attr(this._guid))},getAllAsArray:function(){var t=[],e=r.attr(this._guid);for(var n in e){var i=e[n];"object"!==r.typeOf(i)||i.id||(i.id=n),t.push(i)}return t},has:function(t){return"undefined"!=typeof r.attr(this._guid)[t]},map:function(t,e){var n=[];return this.each(function(i,r){n.push(t.call(e||this,i,r))},e||this),n},push:function(t,e){if("array"===r.typeOf(t))for(var n=0,i=t.length;i>n;n++)r.setAttribute.call(this,r.makeUuid(),t[n],e||!1);else r.setAttribute.call(this,r.makeUuid(),t,e||!1);return this},remove:function(t,e){return"undefined"==typeof t?(r.attributes[this._guid]={},this.emit("change remove")):"function"==typeof t?this.each(function(n,i){t(n)&&r.removeAttribute.call(this,i,e)}):r.removeAttribute.call(this,t,e||!1),this},set:function(t,e,n){if("object"==typeof t)for(var i in t)r.setAttribute.call(this,i,t[i],e||!1);else r.setAttribute.call(this,t,e,n||!1);return this},size:function(){var t=0,e=r.attr(this._guid);for(var n in e)t++;return t},update:function(t,e,n){return"string"==typeof t?r.updateAttribute.call(this,t,e,n||!1):"function"==typeof t&&this.each(function(e,n){r.updateAttribute.call(this,n,t)}),this}};var o={_:r,extend:function(){return r.extendThis.apply(r.Module.prototype,arguments)},mixinEvents:function(t){return t=t||{},r.addGuid(t),r.extend(t,s)},on:function(){r.addEventHandler.apply(this,arguments)},subclass:function(t,e){return e=e||!1,t=t||{},t.superclass=e?function(){}:r.Module,r.createSubclass(t,!e)},version:t};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=o),exports.Stapes=o):"function"==typeof define&&define.amd?define("stapes",function(){return o}):window.Stapes=o}(),function(){function t(t,n,i,r){return new e(t,n,i,r)}function e(t,e,i,r){this.options=r||{},this.options.adapters=this.options.adapters||{},this.obj=t,this.keypath=e,this.callback=i,this.objectPath=[],this.parse(),n(this.target=this.realize())&&this.set(!0,this.key,this.target,this.callback)}function n(t){return"object"==typeof t&&null!==t}function i(t){throw new Error("[sightglass] "+t)}t.adapters={},e.tokenize=function(t,e,n){var i,r,s=[],o={i:n,path:""};for(i=0;i<t.length;i++)r=t.charAt(i),~e.indexOf(r)?(s.push(o),o={i:r,path:""}):o.path+=r;return s.push(o),s},e.prototype.parse=function(){var n,r,s=this.interfaces();s.length||i("Must define at least one adapter interface."),~s.indexOf(this.keypath[0])?(n=this.keypath[0],r=this.keypath.substr(1)):("undefined"==typeof(n=this.options.root||t.root)&&i("Must define a default root adapter."),r=this.keypath),this.tokens=e.tokenize(r,s,n),this.key=this.tokens.pop()},e.prototype.realize=function(){var t,e=this.obj,i=!1;return this.tokens.forEach(function(r,s){n(e)?("undefined"!=typeof this.objectPath[s]?e!==(t=this.objectPath[s])&&(this.set(!1,r,t,this.update.bind(this)),this.set(!0,r,e,this.update.bind(this)),this.objectPath[s]=e):(this.set(!0,r,e,this.update.bind(this)),this.objectPath[s]=e),e=this.get(r,e)):(i===!1&&(i=s),(t=this.objectPath[s])&&this.set(!1,r,t,this.update.bind(this)))},this),i!==!1&&this.objectPath.splice(i),e},e.prototype.update=function(){var t,e;(t=this.realize())!==this.target&&(n(this.target)&&this.set(!1,this.key,this.target,this.callback),n(t)&&this.set(!0,this.key,t,this.callback),e=this.value(),this.target=t,this.value()!==e&&this.callback())},e.prototype.value=function(){return n(this.target)?this.get(this.key,this.target):void 0},e.prototype.setValue=function(t){n(this.target)&&this.adapter(this.key).set(this.target,this.key.path,t)},e.prototype.get=function(t,e){return this.adapter(t).get(e,t.path)},e.prototype.set=function(t,e,n,i){var r=t?"observe":"unobserve";this.adapter(e)[r](n,e.path,i)},e.prototype.interfaces=function(){var e=Object.keys(this.options.adapters);return Object.keys(t.adapters).forEach(function(t){~e.indexOf(t)||e.push(t)}),e},e.prototype.adapter=function(e){return this.options.adapters[e.i]||t.adapters[e.i]},e.prototype.unobserve=function(){var t;this.tokens.forEach(function(e,n){(t=this.objectPath[n])&&this.set(!1,e,t,this.update.bind(this))},this),n(this.target)&&this.set(!1,this.key,this.target,this.callback)},"undefined"!=typeof module&&module.exports?module.exports=t:"function"==typeof define&&define.amd?define("sightglass",[],function(){return this.sightglass=t}):this.sightglass=t}.call(this),function(){var t,e,n,i,r=function(t,e){return function(){return t.apply(e,arguments)}},s=[].slice,o={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var i in e)o.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t={options:["prefix","templateDelimiters","rootInterface","preloadData","handler"],extensions:["binders","formatters","components","adapters"],"public":{binders:{},components:{},formatters:{},adapters:{},prefix:"rv",templateDelimiters:["{","}"],rootInterface:".",preloadData:!0,handler:function(t,e,n){return this.call(t,e,n.view.models)},configure:function(e){var n,i,r,s;null==e&&(e={});for(r in e)if(s=e[r],"binders"===r||"components"===r||"formatters"===r||"adapters"===r)for(i in s)n=s[i],t[r][i]=n;else t["public"][r]=s},bind:function(e,n,i){var r;return null==n&&(n={}),null==i&&(i={}),r=new t.View(e,n,i),r.bind(),r},init:function(e,n,i){var r,s;return null==i&&(i={}),null==n&&(n=document.createElement("div")),e=t["public"].components[e],n.innerHTML=e.template.call(this,n),r=e.initialize.call(this,n,i),s=new t.View(n,r),s.bind(),s}}},window.jQuery||window.$?(i="on"in jQuery.prototype?["on","off"]:["bind","unbind"],e=i[0],n=i[1],t.Util={bindEvent:function(t,n,i){return jQuery(t)[e](n,i)},unbindEvent:function(t,e,i){return jQuery(t)[n](e,i)},getInputValue:function(t){var e;return e=jQuery(t),"checkbox"===e.attr("type")?e.is(":checked"):e.val()}}):t.Util={bindEvent:function(){return"addEventListener"in window?function(t,e,n){return t.addEventListener(e,n,!1)}:function(t,e,n){return t.attachEvent("on"+e,n)}}(),unbindEvent:function(){return"removeEventListener"in window?function(t,e,n){return t.removeEventListener(e,n,!1)}:function(t,e,n){return t.detachEvent("on"+e,n)}}(),getInputValue:function(t){var e,n,i,r;if("checkbox"===t.type)return t.checked;if("select-multiple"===t.type){for(r=[],n=0,i=t.length;i>n;n++)e=t[n],e.selected&&r.push(e.value);return r}return t.value}},t.TypeParser=function(){function t(){}return t.types={primitive:0,keypath:1},t.parse=function(t){return/^'.*'$|^".*"$/.test(t)?{type:this.types.primitive,value:t.slice(1,-1)}:"true"===t?{type:this.types.primitive,value:!0}:"false"===t?{type:this.types.primitive,value:!1}:"null"===t?{type:this.types.primitive,value:null}:"undefined"===t?{type:this.types.primitive,value:void 0}:isNaN(Number(t))===!1?{type:this.types.primitive,value:Number(t)}:{type:this.types.keypath,value:t}},t}(),t.TextTemplateParser=function(){function t(){}return t.types={text:0,binding:1},t.parse=function(t,e){var n,i,r,s,o,u,a;for(u=[],s=t.length,n=0,i=0;s>i;){if(n=t.indexOf(e[0],i),0>n){u.push({type:this.types.text,value:t.slice(i)});break}if(n>0&&n>i&&u.push({type:this.types.text,value:t.slice(i,n)}),i=n+e[0].length,n=t.indexOf(e[1],i),0>n){o=t.slice(i-e[1].length),r=u[u.length-1],(null!=r?r.type:void 0)===this.types.text?r.value+=o:u.push({type:this.types.text,value:o});break}a=t.slice(i,n).trim(),u.push({type:this.types.binding,value:a}),i=n+e[1].length}return u},t}(),t.View=function(){function e(e,n,i){var s,o,u,a,h,l,c,p,d,f,v,b,m;for(this.els=e,this.models=n,null==i&&(i={}),this.update=r(this.update,this),this.publish=r(this.publish,this),this.sync=r(this.sync,this),this.unbind=r(this.unbind,this),this.bind=r(this.bind,this),this.select=r(this.select,this),this.traverse=r(this.traverse,this),this.build=r(this.build,this),this.buildBinding=r(this.buildBinding,this),this.bindingRegExp=r(this.bindingRegExp,this),this.options=r(this.options,this),this.els.jquery||this.els instanceof Array||(this.els=[this.els]),d=t.extensions,h=0,c=d.length;c>h;h++){if(o=d[h],this[o]={},i[o]){f=i[o];for(s in f)u=f[s],this[o][s]=u}v=t["public"][o];for(s in v)u=v[s],null==(a=this[o])[s]&&(a[s]=u)}for(b=t.options,l=0,p=b.length;p>l;l++)o=b[l],this[o]=null!=(m=i[o])?m:t["public"][o];this.build()}return e.prototype.options=function(){var e,n,i,r,s;for(n={},s=t.extensions.concat(t.options),i=0,r=s.length;r>i;i++)e=s[i],n[e]=this[e];return n},e.prototype.bindingRegExp=function(){return new RegExp("^"+this.prefix+"-")},e.prototype.buildBinding=function(e,n,i,r){var s,o,u,a,h,l,c;return h={},c=function(){var t,e,n,i;for(n=r.split("|"),i=[],t=0,e=n.length;e>t;t++)l=n[t],i.push(l.trim());return i}(),s=function(){var t,e,n,i;for(n=c.shift().split("<"),i=[],t=0,e=n.length;e>t;t++)o=n[t],i.push(o.trim());return i}(),a=s.shift(),h.formatters=c,(u=s.shift())&&(h.dependencies=u.split(/\s+/)),this.bindings.push(new t[e](this,n,i,a,h))},e.prototype.build=function(){var e,n,i,r,s;for(this.bindings=[],n=function(e){return function(i){var r,s,o,u,a,h,l,c,p,d,f,v,b,m;if(3===i.nodeType){if(a=t.TextTemplateParser,(o=e.templateDelimiters)&&(c=a.parse(i.data,o)).length&&(1!==c.length||c[0].type!==a.types.text)){for(p=0,f=c.length;f>p;p++)l=c[p],h=document.createTextNode(l.value),i.parentNode.insertBefore(h,i),1===l.type&&e.buildBinding("TextBinding",h,null,l.value);i.parentNode.removeChild(i)}}else 1===i.nodeType&&(r=e.traverse(i));if(!r){for(b=function(){var t,e,n,r;for(n=i.childNodes,r=[],t=0,e=n.length;e>t;t++)u=n[t],r.push(u);return r}(),m=[],d=0,v=b.length;v>d;d++)s=b[d],m.push(n(s));return m}}}(this),s=this.els,i=0,r=s.length;r>i;i++)e=s[i],n(e);this.bindings.sort(function(t,e){var n,i;return((null!=(n=e.binder)?n.priority:void 0)||0)-((null!=(i=t.binder)?i.priority:void 0)||0)})},e.prototype.traverse=function(e){var n,i,r,s,o,u,a,h,l,c,p,d,f,v,b,m;for(s=this.bindingRegExp(),o="SCRIPT"===e.nodeName||"STYLE"===e.nodeName,v=e.attributes,c=0,d=v.length;d>c;c++)if(n=v[c],s.test(n.name)){if(h=n.name.replace(s,""),!(r=this.binders[h])){b=this.binders;for(u in b)l=b[u],"*"!==u&&-1!==u.indexOf("*")&&(a=new RegExp("^"+u.replace(/\*/g,".+")+"$"),a.test(h)&&(r=l))}r||(r=this.binders["*"]),r.block&&(o=!0,i=[n])}for(m=i||e.attributes,p=0,f=m.length;f>p;p++)n=m[p],s.test(n.name)&&(h=n.name.replace(s,""),this.buildBinding("Binding",e,h,n.value));return o||(h=e.nodeName.toLowerCase(),this.components[h]&&!e._bound&&(this.bindings.push(new t.ComponentBinding(this,e,h)),o=!0)),o},e.prototype.select=function(t){var e,n,i,r,s;for(r=this.bindings,s=[],n=0,i=r.length;i>n;n++)e=r[n],t(e)&&s.push(e);return s},e.prototype.bind=function(){var t,e,n,i,r;for(i=this.bindings,r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push(t.bind());return r},e.prototype.unbind=function(){var t,e,n,i,r;for(i=this.bindings,r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push(t.unbind());return r},e.prototype.sync=function(){var t,e,n,i,r;for(i=this.bindings,r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push("function"==typeof t.sync?t.sync():void 0);return r},e.prototype.publish=function(){var t,e,n,i,r;for(i=this.select(function(t){var e;return null!=(e=t.binder)?e.publishes:void 0}),r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push(t.publish());return r},e.prototype.update=function(t){var e,n,i,r,s,o,u;null==t&&(t={});for(n in t)i=t[n],this.models[n]=i;for(o=this.bindings,u=[],r=0,s=o.length;s>r;r++)e=o[r],u.push("function"==typeof e.update?e.update(t):void 0);return u},e}(),t.Binding=function(){function e(t,e,n,i,s){this.view=t,this.el=e,this.type=n,this.keypath=i,this.options=null!=s?s:{},this.getValue=r(this.getValue,this),this.update=r(this.update,this),this.unbind=r(this.unbind,this),this.bind=r(this.bind,this),this.publish=r(this.publish,this),this.sync=r(this.sync,this),this.set=r(this.set,this),this.eventHandler=r(this.eventHandler,this),this.formattedValue=r(this.formattedValue,this),this.parseTarget=r(this.parseTarget,this),this.observe=r(this.observe,this),this.setBinder=r(this.setBinder,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.formatterObservers={},this.model=void 0,this.setBinder()}return e.prototype.setBinder=function(){var t,e,n,i;if(!(this.binder=this.view.binders[this.type])){i=this.view.binders;for(t in i)n=i[t],"*"!==t&&-1!==t.indexOf("*")&&(e=new RegExp("^"+t.replace(/\*/g,".+")+"$"),e.test(this.type)&&(this.binder=n,this.args=new RegExp("^"+t.replace(/\*/g,"(.+)")+"$").exec(this.type),this.args.shift()))}return this.binder||(this.binder=this.view.binders["*"]),this.binder instanceof Function?this.binder={routine:this.binder}:void 0},e.prototype.observe=function(e,n,i){return t.sightglass(e,n,i,{root:this.view.rootInterface,adapters:this.view.adapters})},e.prototype.parseTarget=function(){var e;return e=t.TypeParser.parse(this.keypath),0===e.type?this.value=e.value:(this.observer=this.observe(this.view.models,this.keypath,this.sync),this.model=this.observer.target)},e.prototype.formattedValue=function(e){var n,i,r,o,u,a,h,l,c,p,d,f,v,b;for(b=this.formatters,o=p=0,f=b.length;f>p;o=++p){for(u=b[o],r=u.match(/[^\s']+|'([^']|'[^\s])*'|"([^"]|"[^\s])*"/g),a=r.shift(),u=this.view.formatters[a],r=function(){var e,n,s;for(s=[],e=0,n=r.length;n>e;e++)i=r[e],s.push(t.TypeParser.parse(i));return s}(),l=[],n=d=0,v=r.length;v>d;n=++d)i=r[n],l.push(0===i.type?i.value:((c=this.formatterObservers)[o]||(c[o]={}),(h=this.formatterObservers[o][n])?void 0:(h=this.observe(this.view.models,i.value,this.sync),this.formatterObservers[o][n]=h),h.value()));(null!=u?u.read:void 0)instanceof Function?e=u.read.apply(u,[e].concat(s.call(l))):u instanceof Function&&(e=u.apply(null,[e].concat(s.call(l))))}return e},e.prototype.eventHandler=function(t){var e,n;return n=(e=this).view.handler,function(i){return n.call(t,this,i,e)}},e.prototype.set=function(t){var e;return t=t instanceof Function&&!this.binder["function"]?this.formattedValue(t.call(this.model)):this.formattedValue(t),null!=(e=this.binder.routine)?e.call(this,this.el,t):void 0},e.prototype.sync=function(){var t,e;return this.set(function(){var n,i,r,s,o,u,a;if(this.observer){if(this.model!==this.observer.target){for(o=this.dependencies,n=0,r=o.length;r>n;n++)e=o[n],e.unobserve();if(this.dependencies=[],null!=(this.model=this.observer.target)&&(null!=(u=this.options.dependencies)?u.length:void 0))for(a=this.options.dependencies,i=0,s=a.length;s>i;i++)t=a[i],e=this.observe(this.model,t,this.sync),this.dependencies.push(e)}return this.observer.value()}return this.value}.call(this))},e.prototype.publish=function(){var t,e,n,i,r,o,u,a,h;if(this.observer){for(i=this.getValue(this.el),u=this.formatters.slice(0).reverse(),r=0,o=u.length;o>r;r++)e=u[r],t=e.split(/\s+/),n=t.shift(),(null!=(a=this.view.formatters[n])?a.publish:void 0)&&(i=(h=this.view.formatters[n]).publish.apply(h,[i].concat(s.call(t))));return this.observer.setValue(i)}},e.prototype.bind=function(){var t,e,n,i,r,s,o;if(this.parseTarget(),null!=(r=this.binder.bind)&&r.call(this,this.el),null!=this.model&&(null!=(s=this.options.dependencies)?s.length:void 0))for(o=this.options.dependencies,n=0,i=o.length;i>n;n++)t=o[n],e=this.observe(this.model,t,this.sync),this.dependencies.push(e);return this.view.preloadData?this.sync():void 0},e.prototype.unbind=function(){var t,e,n,i,r,s,o,u,a,h;for(null!=(o=this.binder.unbind)&&o.call(this,this.el),null!=(u=this.observer)&&u.unobserve(),a=this.dependencies,r=0,s=a.length;s>r;r++)i=a[r],i.unobserve();this.dependencies=[],h=this.formatterObservers;for(n in h){e=h[n];for(t in e)i=e[t],i.unobserve()}return this.formatterObservers={}},e.prototype.update=function(t){var e,n;return null==t&&(t={}),this.model=null!=(e=this.observer)?e.target:void 0,null!=(n=this.binder.update)?n.call(this,t):void 0},e.prototype.getValue=function(e){return this.binder&&null!=this.binder.getValue?this.binder.getValue.call(this,e):t.Util.getInputValue(e)},e}(),t.ComponentBinding=function(e){function n(t,e,n){var i,s,o,u,h,l,c;for(this.view=t,this.el=e,this.type=n,this.unbind=r(this.unbind,this),this.bind=r(this.bind,this),this.locals=r(this.locals,this),this.component=this.view.components[this.type],this["static"]={},this.observers={},this.upstreamObservers={},s=t.bindingRegExp(),l=this.el.attributes||[],u=0,h=l.length;h>u;u++)i=l[u],s.test(i.name)||(o=this.camelCase(i.name),a.call(null!=(c=this.component["static"])?c:[],o)>=0?this["static"][o]=i.value:this.observers[o]=i.value)}return u(n,e),n.prototype.sync=function(){},n.prototype.update=function(){},n.prototype.publish=function(){},n.prototype.locals=function(){var t,e,n,i,r,s;n={},r=this["static"];for(t in r)i=r[t],n[t]=i;s=this.observers;for(t in s)e=s[t],n[t]=e.value();return n},n.prototype.camelCase=function(t){return t.replace(/-([a-z])/g,function(t){return t[1].toUpperCase()})},n.prototype.bind=function(){var e,n,i,r,s,o,u,a,h,l,c,p,d,f,v,b,m,g,y,w,x;if(!this.bound){f=this.observers;for(n in f)i=f[n],this.observers[n]=this.observe(this.view.models,i,function(t){return function(e){return function(){return t.componentView.models[e]=t.observers[e].value()}}}(this).call(this,n));this.bound=!0}if(null!=this.componentView)return this.componentView.bind();for(this.el.innerHTML=this.component.template.call(this),u=this.component.initialize.call(this,this.el,this.locals()),this.el._bound=!0,o={},v=t.extensions,l=0,p=v.length;p>l;l++){if(s=v[l],o[s]={},this.component[s]){b=this.component[s];for(e in b)a=b[e],o[s][e]=a}m=this.view[s];for(e in m)a=m[e],null==(h=o[s])[e]&&(h[e]=a)}for(g=t.options,c=0,d=g.length;d>c;c++)s=g[c],o[s]=null!=(y=this.component[s])?y:this.view[s];this.componentView=new t.View(this.el,u,o),this.componentView.bind(),w=this.observers,x=[];for(n in w)r=w[n],x.push(this.upstreamObservers[n]=this.observe(this.componentView.models,n,function(t){return function(e,n){return function(){return n.setValue(t.componentView.models[e])}}}(this).call(this,n,r)));return x},n.prototype.unbind=function(){var t,e,n,i,r;n=this.upstreamObservers;for(t in n)e=n[t],e.unobserve();i=this.observers;for(t in i)e=i[t],e.unobserve();return null!=(r=this.componentView)?r.unbind.call(this):void 0},n}(t.Binding),t.TextBinding=function(t){function e(t,e,n,i,s){this.view=t,this.el=e,this.type=n,this.keypath=i,this.options=null!=s?s:{},this.sync=r(this.sync,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.formatterObservers={}}return u(e,t),e.prototype.binder={routine:function(t,e){return t.data=null!=e?e:""}},e.prototype.sync=function(){return e.__super__.sync.apply(this,arguments)},e}(t.Binding),t["public"].binders.text=function(t,e){return null!=t.textContent?t.textContent=null!=e?e:"":t.innerText=null!=e?e:""},t["public"].binders.html=function(t,e){return t.innerHTML=null!=e?e:""},t["public"].binders.show=function(t,e){return t.style.display=e?"":"none"},t["public"].binders.hide=function(t,e){return t.style.display=e?"none":""},t["public"].binders.enabled=function(t,e){return t.disabled=!e},t["public"].binders.disabled=function(t,e){return t.disabled=!!e},t["public"].binders.checked={publishes:!0,priority:2e3,bind:function(e){return t.Util.bindEvent(e,"change",this.publish)},unbind:function(e){return t.Util.unbindEvent(e,"change",this.publish)},routine:function(t,e){var n;return"radio"===t.type?t.checked=(null!=(n=t.value)?n.toString():void 0)===(null!=e?e.toString():void 0):t.checked=!!e}},t["public"].binders.unchecked={publishes:!0,priority:2e3,bind:function(e){return t.Util.bindEvent(e,"change",this.publish)},unbind:function(e){return t.Util.unbindEvent(e,"change",this.publish)},routine:function(t,e){var n;return"radio"===t.type?t.checked=(null!=(n=t.value)?n.toString():void 0)!==(null!=e?e.toString():void 0):t.checked=!e}},t["public"].binders.value={publishes:!0,priority:3e3,bind:function(e){return"INPUT"!==e.tagName||"radio"!==e.type?(this.event="SELECT"===e.tagName?"change":"input",t.Util.bindEvent(e,this.event,this.publish)):void 0},unbind:function(e){return"INPUT"!==e.tagName||"radio"!==e.type?t.Util.unbindEvent(e,this.event,this.publish):void 0},routine:function(t,e){var n,i,r,s,o,u,h;if("INPUT"===t.tagName&&"radio"===t.type)return t.setAttribute("value",e);if(null!=window.jQuery){if(t=jQuery(t),(null!=e?e.toString():void 0)!==(null!=(s=t.val())?s.toString():void 0))return t.val(null!=e?e:"")}else if("select-multiple"===t.type){if(null!=e){for(h=[],i=0,r=t.length;r>i;i++)n=t[i],h.push(n.selected=(o=n.value,a.call(e,o)>=0));return h}}else if((null!=e?e.toString():void 0)!==(null!=(u=t.value)?u.toString():void 0))return t.value=null!=e?e:""}},t["public"].binders["if"]={block:!0,priority:4e3,bind:function(t){var e,n;return null==this.marker?(e=[this.view.prefix,this.type].join("-").replace("--","-"),n=t.getAttribute(e),this.marker=document.createComment(" rivets: "+this.type+" "+n+" "),this.bound=!1,t.removeAttribute(e),t.parentNode.insertBefore(this.marker,t),t.parentNode.removeChild(t)):void 0},unbind:function(){var t;return null!=(t=this.nested)?t.unbind():void 0},routine:function(e,n){var i,r,s,o;if(!!n==!this.bound){if(n){s={},o=this.view.models;for(i in o)r=o[i],s[i]=r;return(this.nested||(this.nested=new t.View(e,s,this.view.options()))).bind(),this.marker.parentNode.insertBefore(e,this.marker.nextSibling),this.bound=!0}return e.parentNode.removeChild(e),this.nested.unbind(),this.bound=!1}},update:function(t){var e;return null!=(e=this.nested)?e.update(t):void 0}},t["public"].binders.unless={block:!0,priority:4e3,bind:function(e){return t["public"].binders["if"].bind.call(this,e)},unbind:function(){return t["public"].binders["if"].unbind.call(this)},routine:function(e,n){return t["public"].binders["if"].routine.call(this,e,!n)},update:function(e){return t["public"].binders["if"].update.call(this,e)}},t["public"].binders["on-*"]={"function":!0,priority:1e3,unbind:function(e){return this.handler?t.Util.unbindEvent(e,this.args[0],this.handler):void 0},routine:function(e,n){return this.handler&&t.Util.unbindEvent(e,this.args[0],this.handler),t.Util.bindEvent(e,this.args[0],this.handler=this.eventHandler(n))}},t["public"].binders["each-*"]={block:!0,priority:4e3,bind:function(t){var e,n,i,r,s;if(null==this.marker)e=[this.view.prefix,this.type].join("-").replace("--","-"),this.marker=document.createComment(" rivets: "+this.type+" "),this.iterated=[],t.removeAttribute(e),t.parentNode.insertBefore(this.marker,t),t.parentNode.removeChild(t);else for(s=this.iterated,i=0,r=s.length;r>i;i++)n=s[i],n.bind()},unbind:function(t){var e,n,i,r,s;if(null!=this.iterated){for(r=this.iterated,s=[],n=0,i=r.length;i>n;n++)e=r[n],s.push(e.unbind());return s}},routine:function(e,n){var i,r,s,o,u,a,h,l,c,p,d,f,v,b,m,g,y,w,x,k,V;if(h=this.args[0],n=n||[],this.iterated.length>n.length)for(w=Array(this.iterated.length-n.length),f=0,m=w.length;m>f;f++)s=w[f],d=this.iterated.pop(),d.unbind(),this.marker.parentNode.removeChild(d.els[0]);for(o=v=0,g=n.length;g>v;o=++v)if(a=n[o],r={index:o},r[h]=a,null==this.iterated[o]){x=this.view.models;for(u in x)a=x[u],null==r[u]&&(r[u]=a);c=this.iterated.length?this.iterated[this.iterated.length-1].els[0]:this.marker,l=this.view.options(),l.preloadData=!0,p=e.cloneNode(!0),d=new t.View(p,r,l),d.bind(),this.iterated.push(d),this.marker.parentNode.insertBefore(p,c.nextSibling)}else this.iterated[o].models[h]!==a&&this.iterated[o].update(r);if("OPTION"===e.nodeName){for(k=this.view.bindings,V=[],b=0,y=k.length;y>b;b++)i=k[b],i.el===this.marker.parentNode&&"value"===i.type?V.push(i.sync()):V.push(void 0);return V}},update:function(t){var e,n,i,r,s,o,u,a;e={};for(n in t)i=t[n],n!==this.args[0]&&(e[n]=i);for(u=this.iterated,a=[],s=0,o=u.length;o>s;s++)r=u[s],a.push(r.update(e));return a}},t["public"].binders["class-*"]=function(t,e){var n;return n=" "+t.className+" ",!e==(-1!==n.indexOf(" "+this.args[0]+" "))?t.className=e?""+t.className+" "+this.args[0]:n.replace(" "+this.args[0]+" "," ").trim():void 0},t["public"].binders["*"]=function(t,e){return null!=e?t.setAttribute(this.type,e):t.removeAttribute(this.type)},t["public"].adapters["."]={id:"_rv",counter:0,weakmap:{},weakReference:function(t){var e,n,i;return t.hasOwnProperty(this.id)||(e=this.counter++,Object.defineProperty(t,this.id,{value:e})),(n=this.weakmap)[i=t[this.id]]||(n[i]={callbacks:{}})},cleanupWeakReference:function(t,e){return Object.keys(t.callbacks).length||t.pointers&&Object.keys(t.pointers).length?void 0:delete this.weakmap[e]},stubFunction:function(t,e){var n,i,r;return i=t[e],n=this.weakReference(t),r=this.weakmap,t[e]=function(){var e,s,o,u,a,h,l,c,p,d;u=i.apply(t,arguments),l=n.pointers;for(o in l)for(s=l[o],d=null!=(c=null!=(p=r[o])?p.callbacks[s]:void 0)?c:[],a=0,h=d.length;h>a;a++)(e=d[a])();return u}},observeMutations:function(t,e,n){var i,r,s,o,u,h;if(Array.isArray(t)){if(s=this.weakReference(t),null==s.pointers)for(s.pointers={},r=["push","pop","shift","unshift","sort","reverse","splice"],u=0,h=r.length;h>u;u++)i=r[u],this.stubFunction(t,i);if(null==(o=s.pointers)[e]&&(o[e]=[]),a.call(s.pointers[e],n)<0)return s.pointers[e].push(n)}},unobserveMutations:function(t,e,n){var i,r,s;return Array.isArray(t)&&null!=t[this.id]&&(r=this.weakmap[t[this.id]])&&(s=r.pointers[e])?((i=s.indexOf(n))>=0&&s.splice(i,1),s.length||delete r.pointers[e],this.cleanupWeakReference(r,t[this.id])):void 0},observe:function(t,e,n){var i,r,s;return i=this.weakReference(t).callbacks,null==i[e]&&(i[e]=[],r=Object.getOwnPropertyDescriptor(t,e),(null!=r?r.get:void 0)||(null!=r?r.set:void 0)||(s=t[e],Object.defineProperty(t,e,{enumerable:!0,get:function(){return s},set:function(r){return function(o){var u,h,l,c;if(o!==s&&(r.unobserveMutations(s,t[r.id],e),s=o,u=r.weakmap[t[r.id]])){if(i=u.callbacks,i[e])for(c=i[e].slice(),h=0,l=c.length;l>h;h++)n=c[h],a.call(i[e],n)>=0&&n();return r.observeMutations(o,t[r.id],e)}}}(this)}))),a.call(i[e],n)<0&&i[e].push(n),this.observeMutations(t[e],t[this.id],e)},unobserve:function(t,e,n){var i,r,s;return(s=this.weakmap[t[this.id]])&&(i=s.callbacks[e])?((r=i.indexOf(n))>=0&&(i.splice(r,1),i.length||delete s.callbacks[e]),this.unobserveMutations(t[e],t[this.id],e),this.cleanupWeakReference(s,t[this.id])):void 0},get:function(t,e){return t[e]},set:function(t,e,n){return t[e]=n}},t.factory=function(e){return t.sightglass=e,t["public"]._=t,t["public"]},"object"==typeof("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=t.factory(require("sightglass")):"function"==typeof define&&define.amd?define("rivets",["sightglass"],function(e){return this.rivets=t.factory(e)}):this.rivets=t.factory(sightglass)}.call(this),define("mcore/route",["mcore/util"],function(t){"use strict";var e,n,i;return i=function(t,e,n,i){var r;return null==e&&(e=[]),null==n&&(n=!1),null==i&&(i=!1),t instanceof RegExp?t:(r=function(t,n,i,r,s,o){return e.push({name:r,optional:!!o}),n=n||"",""+(o&&""||n)+"(?:"+(o&&n||"")+(i||"")+(s||i&&"([^/.]+?)"||"([^/]+?)")+")"+(o||"")},t=t.concat(i&&""||"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,r).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+t+"$",n&&""||"i"))},n=function(e){var n,i,r,s,o;return e=String(e),n="",r=[],-1!==e.indexOf("?")?n=e.split("?").pop():-1!==e.indexOf("&")&&(n=e),""===n?{}:(i=n.split("&"),s={},o=[],i.forEach(function(e){var n,i;-1!==e.indexOf("=")&&(e=e.split("="),2===e.length&&(n=e[0].trim(),i=e[1],i=t.isNumber(i)?Number(i):decodeURIComponent(i),s[n]=i))}),s)},e=function(t,n,i){
this.hashchange=null!=t?t:e.changeByLocationHash,this.sensitive=null!=n?n:!1,this.strict=null!=i?i:!1,this.rule=[]},e.prototype.run=function(){this.hashchange(function(t){return function(e){t.match(e)}}(this))},e.prototype.add=function(t,e){var n,r;return n=[],r=i(t,n,this.sensitive,this.strict),this.rule.push({path:t,reg:r,keys:n,fn:e}),this},e.prototype.match=function(e){var i,r,s,o,u;return u=String(e),r=u,i="",s=u.indexOf("?"),-1===s&&(s=u.indexOf("&")),o=!1,-1!==s&&(i=u.substring(s),u=u.substring(0,s)),t.each(this.rule,function(e){var s,a,h,l,c,p,d,f,v,b;if(o)return!1;if(f=e.reg.exec(u),null!==f){for(o=!0,a=n(i),h={},s=[],c=p=1,v=f.length;v>=1?v>p:p>v;c=v>=1?++p:--p)d=e.keys[c-1],b=f[c],t.isNumber(b)?b=Number(b):b&&(b=decodeURIComponent(b)),d&&d.name&&(h[d.name]=b),s.push(b||null);l={url:r,path:u,args:i,rule:e.path,context:a,keys:e.keys,data:h},e.fn.apply(l,s)}}),this},e.changeByLocationHash=function(t){var e;return e=function(){return t(window.location.hash.substring(1))},window.addEventListener?window.addEventListener("hashchange",e,!1):window.attachEvent("onhashchange",e),e()},e.changeByHistory=function(t){var n;return window.history||e.changeByLocationHash(t),n=function(){return t(window.location.hash.substring(1))},window.onpopstate=function(t){return n()},n()},{pathToRegexp:i,pathToObject:n,Route:e}}),function(){var t=[].slice;define("mcore/template",["jquery","rivets","mcore/util","stapes"],function(e,n,i,r){"use strict";var s;return n.adapters[":"]={observe:function(t,e,n){t.on("change:"+e,n)},unobserve:function(t,e,n){t.off("change:"+e,n)},get:function(t,e){return t.get(e)},set:function(t,e,n){t.set(e,n)}},n.configure({rootInterface:".",handler:function(t,e,n){var i;return i=this.call(n.view.models.self,t,e),!1===i?e.stopPropagation&&e.preventDefault?(e.stopPropagation(),e.preventDefault()):(window.event.cancelBubble=!0,window.event.returnValue=!1):void 0}}),n.formatters.nl2br=function(t){return t?String(t).trim().replace(/<[^>]+>/g,"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br/>$2"):""},n.formatters.link=function(t,e){return t?String(t)+String(e):""},n.formatters.and=function(t,e){return t?e:t},n.formatters.or=function(t,e){return t?t:e},n.formatters.slice=function(t,e,n){return!1===Array.isArray(t)?[]:t.slice(e,n)},n.formatters.substr=function(t,e,n){return t?String(t).substring(e,n):""},n.formatters.len=function(t){return Array.isArray(t)?t.length:t?String(t).length:0},n.formatters.eq=function(t,e){return t===e},n.formatters["<"]=function(t,e){return Number(t)<Number(e)},n.formatters["<="]=function(t,e){return Number(t)<=Number(e)},n.formatters["=="]=function(t,e){return Number(t)===Number(e)},n.formatters[">="]=function(t,e){return Number(t)>=Number(e)},n.formatters[">"]=function(t,e){return Number(t)>Number(e)},n.formatters["+"]=function(t,e){return Number(t)+Number(e)},n.formatters["-"]=function(t,e){return Number(t)-Number(e)},n.formatters["*"]=function(t,e){return Number(t)*Number(e)},n.formatters["/"]=function(t,e){return Number(t)/Number(e)},n.formatters.isArray=function(t){return Array.isArray(t)},n.formatters.eachObject=function(t){var e,n,r,s;if(!1===i.isObject(t))return[];e=[],r=[];for(n in t)s=t[n],r.push(e.push({key:n,value:s}));return r},n.formatters.toFixed=function(t,e){return null==e&&(e=1),!1===i.isNumber(t)?0:Number(t).toFixed(e)},n.formatters["in"]=function(){var e,n;return e=1<=arguments.length?t.call(arguments,0):[],e.length<2?!1:(n=e[0],e.splice(0,1),i.isNumber(n)&&(n=Number(n)),-1!==e.indexOf(n))},s=function(t,e){this.view=t,this.data=null!=e?e:{},this.rv=!1},s.prototype.init=function(){var t,i,r,o;return t=this.data,r=Object.keys(t),i=e.Deferred(),0===r.length?(o=n.bind(this.view.$el,{self:this.view}),this.rv=o,i.resolve(o)):s.loadPromise(t).done(function(t){return function(e){r.forEach(function(n){var i;return i=e[n],null!=i?t.view.set(n,i):void 0}),o=n.bind(t.view.$el,{self:t.view}),t.rv=o,i.resolve(o)}}(this)).fail(function(){return i.reject("template render error")}),i.promise()},s.prototype.set=function(t,e){return e.then(function(e){return function(n){return e.view.set(t,n)}}(this))},s.prototype.update=function(t){var n,i;return null==t&&(t={}),n=e.Deferred(),!1===this.rv?n.reject("Template no init"):(i=Object.keys(t),s.loadPromise(t).done(function(t){return function(e){i.forEach(function(n){var i;return i=e[n],null!=i?t.view.set(n,i):void 0}),n.resolve}}(this)).fail(function(){return n.reject("template update error")})),n.promise()},s.prototype.destroy=function(){return this.rv?this.rv.unbind():void 0},s.loadPromise=function(n){var i,r,s;return i=e.Deferred(),r=Object.keys(n),0===r.length?i.resolve({}):(s=[],r.forEach(function(t){return function(t){return s.push(n[t])}}(this)),e.when.apply(null,s).done(function(){var e,n;return e=1<=arguments.length?t.call(arguments,0):[],n={},e.forEach(function(t){return function(t,e){var i;return i=r[e],i?(Array.isArray(t)&&3===t.length&&t[2].promise&&(t=t[0]),n[i]=t):void 0}}(this)),i.resolve(n)}).fail(function(t){return console.log(t),i.reject(t)})),i.promise()},s.loadTpl=function(t){var n,i;return n=e.Deferred(),i=String(t).split("/"),2===i.length?requirejs(["tpl/"+i[0]],function(t){var e;return e=t[i[1]],e?n.resolve(e):n.reject("url data map error")}):n.reject("uri error: "+t),n.promise()},s.renderString=function(t,e,n){var i,r,o;return null==e&&(e={}),o=Object.keys(e),o.length>0&&!n.tpl&&o.forEach(function(t){return function(t){return n.set(t,{})}}(this)),n.tpl?n.tpl.update(e).then(function(){return n.emit("tplUpdate")}):(i=n.$el.parent(),r=i.length>0,r&&n.$el.detach(),n.$el.append(t),n.tpl=new s(n,e),n.tpl.init().then(function(){return r&&n.$el.appendTo(i),n.emit("render"),n.tpl}))},s.render=function(t,e,n){return null==e&&(e={}),s.loadTpl(t).then(function(t){return s.renderString(t,e,n)})},s.formatters=function(t,e){return n.formatters[t]=e},s.Attr=r.subclass({constructor:function(t,n,i){return this.name=t,this.rv=n,this.el=i,this.$el=e(this.el),this.init(this.el),this.watch()},sync:function(t){return this.rv.observer.setValue(t)},init:function(t){},update:function(t,e){},destroy:function(t){},watch:function(){}}),s.regAttr=function(t,e){var i;return i=null,n.binders[t]={bind:function(n){return i=new e(t,this,n)},unbind:function(t){return i.destroy(t)},routine:function(t,e){return i.update(e,t)}}},s.regTag=function(t,e){return null==e&&(e={}),n.components[t]={"static":e["static"]||[],attributes:e.attr||[],template:e.template||function(){return""},initialize:e.init||function(){}}},s})}.call(this),function(){define("mcore/ui",["jquery","mcore/template","stapes"],function(t,e,n){"use strict";return n.subclass({constructor:function(e,n){return this.options=null!=n?n:{},this.$el=t("<div/>"),this.$parent=e,this.on("render",function(t){return function(){return t.$el.appendTo(t.$parent)}}(this)),this.init(),this.watch()},destroy:function(){return this.tpl&&this.tpl.destroy(),this.$el.remove()},render:function(t,n){return null==n&&(n={}),e.render(t,n,this)},renderString:function(t,n){return null==n&&(n={}),e.renderString(t,n,this)},init:function(){},watch:function(){}})})}.call(this),function(){define("mcore/view",["jquery","mcore/template","stapes","mcore/util"],function(t,e,n,i){"use strict";var r,s,o,u;return s=t(window),r=t("body"),u=/MicroMessenger/i.test(window.navigator.userAgent),o=/iphone|ipad/gi.test(window.navigator.appVersion),n.subclass({constructor:function(t,e){return this.$el=t,this.app=e,this.$win=s,this.$body=r,this.util=i,this._cacheMap={},this.isWeixinBrowser=u,this.isIOS=o,this.tpl=!1,this.beforeInit(),this.init(),this.watch()},clone:function(t){return i.clone(t)},setTitle:function(e){var n;return this.title=e,document.title!==this.title?(document.title=this.title,this.isWeixinBrowser&&this.isIOS?(n=t('<iframe src="/favicon.ico"></iframe>'),n.one("load",function(){return setTimeout(function(){return n.remove()},0)}).appendTo(this.$body)):void 0):void 0},render:function(t,n){return null==n&&(n={}),e.render(t,n,this)},renderString:function(t,n){return null==n&&(n={}),e.renderString(t,n,this)},when:function(){return t.when.apply(this,arguments)},destroy:function(){return this.tpl&&this.tpl.destroy(),this.$el.remove()},memoryCache:function(t){var e,n;return n=i.promiseCacheMemoryproxy,e={has:function(e){return i.promiseCache(t,e,{proxy:n})},remove:function(){return n.remove(t)}}},localCache:function(t){var e,n;return n=i.promiseCacheLocalProxy,e={has:function(e,r){return null==r&&(r=1/0),i.promiseCache(t,e,{proxy:n,time:r})},remove:function(){return n.remove(t)}}},sessionCach:function(t){var e,n;return n=this.promiseCacheSessionProxy(),e={has:function(e){return i.promiseCache(t,e,{proxy:n})},remove:function(){return n.remove(t)}}},promiseCacheSessionProxy:function(){var t;return t={set:function(t){return function(e,n){return t._cacheMap[e]=n}}(this),get:function(t){return function(e){return t._cacheMap[e]||null}}(this)}},back:function(){return window.history.length>1?window.history.back():window.location.href="#",!1},beforeInit:function(){},init:function(){},run:function(){},afterRun:function(){},watch:function(){}})})}.call(this),function(){define("mcore/util",function(){"use strict";var t,e,n,i,r;return r={},e=/^-{0,1}\d*\.{0,1}\d+$/,t="__cache_",n=window.localStorage,i={},r.isNumber=function(t){return e.test(t)},r.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)},r.clone=function(t){return JSON.parse(JSON.stringify(t))},r.cache={set:function(e,i,r){var s;return null==r&&(r=1/0),r!==1/0&&(r=(new Date).getTime()+parseInt(r)),s={time:r,value:i},n.setItem(t+e,JSON.stringify(s))},get:function(e,i){var s,o;return null==i&&(i=null),(o=n.getItem(t+e))?(o=JSON.parse(o),s=(new Date).getTime(),s<=o.time?o.value:(r.cache.remove(e),i)):i},remove:function(e){return n.removeItem(t+e)}},r.promiseCache=function(t,e,n){var i,s;return i=n.proxy.get(t),i?(s=$.Deferred(),s.resolve(r.clone(i)),s.promise()):e().then(function(e){return n.proxy.set(t,r.clone(e),n.time)})},r.promiseCacheLocalProxy={set:r.cache.set,get:r.cache.get,remove:r.cache.remove},r.promiseCacheMemoryproxy={set:function(t,e){return i[t]=e},get:function(t){return i[t]||null},remove:function(t){return delete i[t]}},r.each=function(t,e){var n,i,r;if(null==e&&(e=function(){}),!1!==Array.isArray(t))for(n in t)if(r=t[n],i=e(r,n),!1===i)break},r})}.call(this),function(){define("mcore/app",["jquery","stapes","mcore/route"],function(t,e,n){"use strict";return e.subclass({constructor:function(e,i){this.$el=e,null==i&&(i={}),this.options=t.extend({viewClass:"mcore-app-view",routeChange:n.Route.changeByLocationHash},i),this.router=new n.Route(this.options.routeChange),this.curView=null,this.onLoadViw=!1},route:function(t,e){var n;return n=this,this.router.add(t,function(){return n.runView(e,this,arguments)}),this},runView:function(e,n,i){if(!this.onLoadViw){if(this.curView){if(this.curView.name===e)return this.curView.instantiate.route=n,this.curView.instantiate.context=n.context,this.curView.instantiate.run.apply(this.curView.instantiate,i),void this.emit("runView",this.curView);this.emit("destroyView",this.curView),this.curView.instantiate.destroy(),this.curView=null}return this.onLoadViw=!0,requirejs([e],function(r){return function(s){var o;return o=t("<div class='"+r.options.viewClass+"' />"),r.curView={name:e,instantiate:new s(o,r)},r.curView.instantiate.route=n,r.curView.instantiate.context=n.context,r.curView.instantiate.run.apply(r.curView.instantiate,i),r.curView.instantiate.$el.appendTo(r.$el),r.emit("runView",r.curView),r.curView.instantiate.afterRun(),r.onLoadViw=!1}}(this))}},run:function(){return this.router.run()}})})}.call(this),function(){define("mcore",["mcore/util","mcore/template","mcore/view","mcore/route","mcore/ui","mcore/app"],function(t,e,n,i,r,s){"use strict";var o;return o={util:t,Template:e,View:n,Route:i,Ui:r,App:s}})}.call(this);
//# sourceMappingURL=mcore.min.js.map