define(["jquery","mcore"],function(e,t){return function(e){function t(r){if(i[r])return i[r].exports;var o=i[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){"use strict";var t,r,o;o=i(13),i(16),r=i(14),r.ext={validator:o},t=e.exports=r},,,,function(t,i){t.exports=e},,,,,,,,,function(e,t,i){"use strict";var r,o,n,l,a,s,c,_,u,h,t,f,p,m,g,d=[].slice;r=i(4),f=i(14),i(15),o=f.Template,g=f.util,l=/^[A-Za-z]+$/,s=/^(?:[a-z0-9]+[_\-+.]+)*[a-z0-9]+@(?:([a-z0-9]+-?)*[a-z0-9]+.)+([a-z]{2,})+$/i,a=/^([1-2]\d{3})([-\/.])?(1[0-2]|0?[1-9])([-\/.])?([1-2]\d|3[01]|0?[1-9])$/,_=/^1[3-9]\d{9}$/,u=/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/,c=/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i,m=function(){var e,t,i,r,o,n,l,a,s,c;return l="((https?|s?ftp|irc[6s]?|git|afp|telnet|smb):\\/\\/)?",c="([a-z0-9]\\w*(\\:[\\S]+)?\\@)?",t="(?:localhost|(?:[a-z0-9]+(?:[-\\w]*[a-z0-9])?(?:\\.[a-z0-9][-\\w]*[a-z0-9])*)*\\.[a-z]{2,})",n="(:\\d{1,5})?",r="\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}",e="(\\/\\S*)?",i=[l,c,t,n,e],o=[l,c,r,n,e],a=new RegExp("^"+i.join("")+"$","i"),s=new RegExp("^"+o.join("")+"$","i"),function(e){return a.test(e||s.test(e))}}(),h={required:"不能为空",isNumber:"只能是数字",isAlphabet:"只能是字母",minlength:function(e){return"最小 "+e+" 位字符"},maxlength:function(e){return"最多 "+e+" 位字符"},min:function(e){return"数值要大于 "+e},max:function(e){return"数值要小于 "+e},equals:"两次输入的值不相符",isEmail:"邮箱格式不正确",isInteger:"数值必须是整数",isDate:"日期格式不正确",isMobile:"手机格式不正确",isTel:"座机格式不正确",isIdentityCode:"身份证号格式错误"},p={required:function(e){return null==e&&(e=""),String(e).trim().length>0},isAlphabet:function(e){return l.test(e)},minlength:function(e,t){return t=Number(t),e=String(e).trim(),e.length>=t},maxlength:function(e,t){return t=Number(t),e=String(e).trim(),e.length<t},isNumber:function(e){return r.isNumeric(e)},isInteger:function(e){return Number(e)%1===0},min:function(e,t){return Number(e)>=Number(t)},max:function(e,t){return Number(e)<=Number(t)},equals:function(e,t){return t instanceof r&&(t=t.val()),e instanceof r&&(e=e.val()),String(e)===String(t)},isEmail:function(e){return s.test(e)},isDate:function(e){var t,i,r,o,n;return a.test(e)?!1:(o=a.exec(e),n=Number(o[1]),r=Number(o[3]-1),i=Number(o[5]),t=new Date(n,r,i),n===t.getFullYear()&&r===t.getMonth()&&i===t.getDate())},isMobile:function(e){return _.test(e)},isTel:function(e){return u.test(e)},isIdentityCode:function(e){var t,i,r,o,n,l,a,s,_,u;if(e=String(e).replace("x","X"),i={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"},c.test(e))return!1;if(!i[e.substr(0,2)])return!1;if(18===e.length){for(r=e.split(""),o=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],s=[1,0,"X",9,8,7,6,5,4,3,2],_=0,t=0,u=0,n=l=0;17>l;n=++l)t=r[n],u=o[n],_+=t*u;if(a=s[_%11],a!==r[17])return!1}return!0},isUrl:function(e){return m(e)}},n=o.Attr.subclass({constructor:o.Attr.prototype.constructor,init:function(){return this.$el.is("form")===!1?!1:this.$el.data("check",function(e){return function(){return e.initRules(),e.check()}}(this))},update:function(e){return this.$el.is("form")?void 0:e?this.$el.attr("validator",e):this.$el.removeAttr("validator")},check:function(){var e,t,i,o;return o=!0,t=this.$el.serializeObject(),i=null,e=this.$el,r.each(this.rules,function(r,n){var l;if("required"===n.type||""!==t[n.name]&&void 0!==t[n.name])return l=n.args[0],n.args[0]=t[n.name],!1===n.rule.apply(null,n.args)?(i=function(){return{$el:l,err:n.err,$form:e}},o=!1,!1):void 0}),o&&t||i},initRules:function(){var e;return e=this,this.rules=[],this.$validators=this.$el.find("[validator]"),this.$validators.each(function(){return e.parseValidator(r(this))})},parseValidator:function(e){var t;return(t=e.attr("name"))?e.attr("validator").split("|").forEach(function(i){return function(o){var n,l,a,s,c,_,u,f;return _=String(o).indexOf(" err:"),-1!==_&&(s=o.split(" err:"),o=s[0],a=s[1]),n=o.split(" ").filter(function(e){return r.trim(e).length>0}),f=n[0],(l=p[f])?(a?c=a:r.isFunction(h[f])?(u=g.clone(n),u.splice(0,1),c=h[f].apply(null,u)):c=h[f]||"error",n[0]=e,"equals"===f&&(n[1]=i.$el.find(n[1]).eq(0)),i.rules.push({name:t,type:f,rule:l,args:n,err:c})):void console.log("validator rule: "+f+" undefined")}}(this)):void 0}}),o.regAttr("validator",n),t=e.exports={add:function(e,t){return p[e]=t},check:function(){var e,t;return e=1<=arguments.length?d.call(arguments,0):[],e.length<2?!1:(t=e[0],e.splice(0,1),p[t]?p[t].apply(null,e):!1)},addErrMsg:function(e,t){return h[e]=t},ValidatorAttr:n}},function(e,i){e.exports=t},function(e,t,i){"use strict";var r=i(4),o=function(e){function t(t,r){function o(e,t,i){return e[t]=i,e}function n(e,t){for(var r,n=e.match(i.key);void 0!==(r=n.pop());)if(i.push.test(r)){var a=l(e.replace(/\[\]$/,""));t=o([],a,t)}else i.fixed.test(r)?t=o([],r,t):i.named.test(r)&&(t=o({},r,t));return t}function l(e){return void 0===f[e]&&(f[e]=0),f[e]++}function a(t){switch(e('[name="'+t.name+'"]',r).attr("type")){case"checkbox":return"on"===t.value?!0:t.value;default:return t.value}}function s(e){if(!i.validate.test(e.name))return this;var r=n(e.name,a(e));return h=t.extend(!0,h,r),this}function c(e){if(!t.isArray(e))throw new Error("formSerializer.addPairs expects an Array");for(var i=0,r=e.length;r>i;i++)this.addPair(e[i]);return this}function _(){return h}function u(){return JSON.stringify(_())}var h={},f={};this.addPair=s,this.addPairs=c,this.serialize=_,this.serializeJSON=u}var i={validate:/^[a-z_][a-z0-9_]*(?:\[(?:\d*|[a-z0-9_]+)\])*$/i,key:/[a-z0-9_]+|(?=\[\])/gi,push:/^$/,fixed:/^\d+$/,named:/^[a-z0-9_]+$/i};return t.patterns=i,t.serializeObject=function(){return new t(e,this).addPairs(this.serializeArray()).serialize()},t.serializeJSON=function(){return new t(e,this).addPairs(this.serializeArray()).serializeJSON()},"undefined"!=typeof e.fn&&(e.fn.serializeObject=t.serializeObject,e.fn.serializeJSON=t.serializeJSON),t}(r);t=e.exports=o},function(e,t,i){"use strict";var r,o,n,l,a,s,c,_,u,h,f,p,m,g,d;r=i(4),m=i(17),h=i(14),l=h.Template,n=r(window),o=r(document),s=document.documentElement.style,s.hasOwnProperty("WebkitAppearance")?c="webkit":s.hasOwnProperty("MozAppearance")?c="gecko":"string"==typeof navigator.cpuClass?c="trident":window.opera&&"[object Opera]"===Object.prototype.toString.call(opera)&&(c="presto"),d={webkit:"Webkit",trident:"ms",gecko:"Moz",presto:"O"}[c],_=document.createElement("div"),f=d+"Perspective",g=d+"Transform",p=function(e){return _.style.hasOwnProperty(f)?function(t,i,r){e.style[g]="translate3d("+-t+"px, "+-i+"px,0) scale("+r+")"}:_.style.hasOwnProperty(g)?function(t,i,r){e.style[g]="translate("+-t+"px, "+-i+"px,0) scale("+r+")"}:function(t,i,r){e.style.marginLeft=t&&-t/r+"px"||"",e.style.marginTop=i&&-i/r+"px"||"",e.style.zoom=r||""}},a=0,u=function(e,t){var i;return null==t&&(t=function(){}),e?(i=new Image,i.onload=t,i.onerror=t,i.src=e):t()},l.regAttr("scroller",l.Attr.subclass({constructor:l.Attr.prototype.constructor,init:function(){return a++,this.id=a,this.scrollingY="yes"===this.$el.attr("data-scrolling-y"),this.scrollingX="yes"===this.$el.attr("data-scrolling-x"),this.scrollingX===this.scrollingY&&this.scrollingX===!1&&(this.scrollingY=!0),this.height=Number(this.$el.attr("data-scrolling-height")||0),this.width=Number(this.$el.attr("data-scrolling-width")||0),this.loadImgTime=!1,this.$el.wrap('<div class="scroller-wrap"></div>'),this.$container=this.$el.parent().css({overflow:"hidden",position:"relative"}),this.$el.css({position:"absolute"}),this.scrollingX===!1&&this.$el.css({width:"100%"}),this.scroller=new m.Scroller(p(this.$el[0]),{scrollingX:this.scrollingX,scrollingY:this.scrollingY,zooming:!1,locking:!1}),this.$el.data("scroller",this.scroller),this.soureSize={width:0,height:0},this.size={width:0,height:0},this.resize()},update:function(e,t){var i,o,n;return this.$el=r(t),this.resize(),i=this.$el.find("img"),o=i.length,o>0?(this.loadImgTime&&clearTimeout(this.loadImgTime),n=0,this.loadImgTime=setTimeout(function(e){return function(){var t;return t=e,i.each(function(){return u(this.src,function(){return n++,n===o?t.resize():void 0})})}}(this),300)):void 0},destroy:function(){return this.$el.remove(),n.off("touchmove.scroller"+this.id).off("touchend.scroller"+this.id).off("mousemove.scroller"+this.id).off("mouseup.scroller"+this.id).off("resize.scroller"+this.id)},getSoureHeight:function(){var e;return e=0,this.$el.children().each(function(){return e+=r(this).outerHeight()}),e},getSoureWidth:function(){var e;return e=0,this.$el.children().each(function(){return e+=r(this).outerWidth()}),e},watch:function(){var e,t,i,r;return e=this.$container[0],i=!1,r=!1,t=!1,this.on("touchend",function(e){return function(t){var i,r;return i=t.e,r=t.vals,r.top+e.size.height>e.soureSize.height?e.$el.trigger("scrollend",i,e):r.top<20?e.$el.trigger("scrollstart",i,e):void 0}}(this)),e.addEventListener("touchstart",function(e){return function(i){return t=!0,i.target.tagName.match(/input|textarea|select/i)?void 0:(r=!0,e.scroller.doTouchStart(i.touches,i.timeStamp),!1)}}(this),!1),n.on("touchmove.scroller"+this.id,function(e){return function(t){var i;return i=t.originalEvent,e.scroller.doTouchMove(i.touches,i.timeStamp,i.scale||1),r?i.preventDefault():void 0}}(this)),n.on("touchend.scroller"+this.id,function(e){return function(i){var o;t=!0,r=!1,o=i.originalEvent,e.scroller.doTouchEnd(o.timeStamp),e.emit("touchend",{e:o,vals:e.scroller.getValues()})}}(this)),e.addEventListener("mousedown",function(e){return function(r){return t||r.target.tagName.match(/input|textarea|select/i)?void 0:(e.scroller.doTouchStart([{pageX:r.pageX,pageY:r.pageY}],r.timeStamp),i=!0)}}(this),!1),n.on("mousemove.scroller"+this.id,function(e){return function(r){var o;if(!t&&(o=r.originalEvent,!1!==i))return e.scroller.doTouchStart([{pageX:o.pageX,pageY:o.pageY}],o.timeStamp),i=!0,o.preventDefault()}}(this)),n.on("mouseup.scroller"+this.id,function(e){return function(r){var o;if(!t&&(o=r.originalEvent,!1!==i))return e.scroller.doTouchEnd(o.timeStamp),e.emit("touchend",{e:o,vals:e.scroller.getValues()}),i=!1}}(this)),n.on("resize.scroller"+this.id,function(e){return function(){return e.resize()}}(this))},resize:function(){return window.requestAnimationFrame?window.requestAnimationFrame(function(e){return function(){return e._resize()}}(this)):this._resize()},_resize:function(){var e,t,i,r,o,l,a,s;return t=this.$container[0],i=this.$el[0],o=t.getBoundingClientRect(),this.scroller.setPosition(o.left+t.clientLeft,o.top+t.clientTop),s=this.width||t.clientWidth,r=this.height||t.clientHeight,a=i.offsetWidth,l=i.offsetHeight,this.scrollingY&&0===this.height&&(r=n.outerHeight()-o.top),this.scrollingY&&r>l&&(l=this.getSoureHeight(),r>l&&(l=r+80)),this.scrollingX&&0===this.width&&(e=this.getSoureWidth()+4,e>a&&(a=e),r=l),this.$container.css({width:s||"100%",height:r||"100%"}),this.soureSize={width:a,height:l},this.size={width:this.$container.width(),height:this.$container.height()},this.scrollingY&&(l+=40),this.scroller.setDimensions(s,r,a,l)}}))},function(e,t){"use strict";!function(e){var t=Date.now||function(){return+new Date},i=60,r=1e3,o={},n=1;e.core?core.effect||(core.effect={}):e.core={effect:{}},core.effect.Animate={requestAnimationFrame:function(){var t=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame,i=!!t;if(t&&!/requestAnimationFrame\(\)\s*\{\s*\[native code\]\s*\}/i.test(t.toString())&&(i=!1),i)return function(e,i){t(e,i)};var r=60,o={},n=0,l=1,a=null,s=+new Date;return function(e,t){var i=l++;return o[i]=e,n++,null===a&&(a=setInterval(function(){var e=+new Date,t=o;o={},n=0;for(var i in t)t.hasOwnProperty(i)&&(t[i](e),s=e);e-s>2500&&(clearInterval(a),a=null)},1e3/r)),i}}(),stop:function(e){var t=null!=o[e];return t&&(o[e]=null),t},isRunning:function(e){return null!=o[e]},start:function(e,l,a,s,c,_){var u=t(),h=u,f=0,p=0,m=n++;if(_||(_=document.body),m%20===0){var g={};for(var d in o)g[d]=!0;o=g}var v=function(n){var g=n!==!0,d=t();if(!o[m]||l&&!l(m))return o[m]=null,void(a&&a(i-p/((d-u)/r),m,!1));if(g)for(var T=Math.round((d-h)/(r/i))-1,S=0;S<Math.min(T,4);S++)v(!0),p++;s&&(f=(d-u)/s,f>1&&(f=1));var z=c?c(f):f;e(z,d,g)!==!1&&1!==f||!g?g&&(h=d,core.effect.Animate.requestAnimationFrame(v,_)):(o[m]=null,a&&a(i-p/((d-u)/r),m,1===f||null==s))};return o[m]=!0,core.effect.Animate.requestAnimationFrame(v,_),m}}}(window);var i;!function(){var e=function(){};i=function(t,i){this.__callback=t,this.options={scrollingX:!0,scrollingY:!0,animating:!0,animationDuration:250,bouncing:!0,locking:!0,paging:!1,snapping:!1,zooming:!1,minZoom:.5,maxZoom:3,speedMultiplier:1,scrollingComplete:e,penetrationDeceleration:.03,penetrationAcceleration:.08};for(var r in i)this.options[r]=i[r]};var t=function(e){return Math.pow(e-1,3)+1},r=function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},o={__isSingleTouch:!1,__isTracking:!1,__didDecelerationComplete:!1,__isGesturing:!1,__isDragging:!1,__isDecelerating:!1,__isAnimating:!1,__clientLeft:0,__clientTop:0,__clientWidth:0,__clientHeight:0,__contentWidth:0,__contentHeight:0,__snapWidth:100,__snapHeight:100,__refreshHeight:null,__refreshActive:!1,__refreshActivate:null,__refreshDeactivate:null,__refreshStart:null,__zoomLevel:1,__scrollLeft:0,__scrollTop:0,__maxScrollLeft:0,__maxScrollTop:0,__scheduledLeft:0,__scheduledTop:0,__scheduledZoom:0,__lastTouchLeft:null,__lastTouchTop:null,__lastTouchMove:null,__positions:null,__minDecelerationScrollLeft:null,__minDecelerationScrollTop:null,__maxDecelerationScrollLeft:null,__maxDecelerationScrollTop:null,__decelerationVelocityX:null,__decelerationVelocityY:null,setDimensions:function(e,t,i,r){var o=this;e===+e&&(o.__clientWidth=e),t===+t&&(o.__clientHeight=t),i===+i&&(o.__contentWidth=i),r===+r&&(o.__contentHeight=r),o.__computeScrollMax(),o.scrollTo(o.__scrollLeft,o.__scrollTop,!0)},setPosition:function(e,t){var i=this;i.__clientLeft=e||0,i.__clientTop=t||0},setSnapSize:function(e,t){var i=this;i.__snapWidth=e,i.__snapHeight=t},activatePullToRefresh:function(e,t,i,r){var o=this;o.__refreshHeight=e,o.__refreshActivate=t,o.__refreshDeactivate=i,o.__refreshStart=r},triggerPullToRefresh:function(){this.__publish(this.__scrollLeft,-this.__refreshHeight,this.__zoomLevel,!0),this.__refreshStart&&this.__refreshStart()},finishPullToRefresh:function(){var e=this;e.__refreshActive=!1,e.__refreshDeactivate&&e.__refreshDeactivate(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0)},getValues:function(){var e=this;return{left:e.__scrollLeft,top:e.__scrollTop,zoom:e.__zoomLevel}},getScrollMax:function(){var e=this;return{left:e.__maxScrollLeft,top:e.__maxScrollTop}},zoomTo:function(e,t,i,r,o){var n=this;if(!n.options.zooming)throw new Error("Zooming is not enabled!");o&&(n.__zoomComplete=o),n.__isDecelerating&&(core.effect.Animate.stop(n.__isDecelerating),n.__isDecelerating=!1);var l=n.__zoomLevel;null==i&&(i=n.__clientWidth/2),null==r&&(r=n.__clientHeight/2),e=Math.max(Math.min(e,n.options.maxZoom),n.options.minZoom),n.__computeScrollMax(e);var a=(i+n.__scrollLeft)*e/l-i,s=(r+n.__scrollTop)*e/l-r;a>n.__maxScrollLeft?a=n.__maxScrollLeft:0>a&&(a=0),s>n.__maxScrollTop?s=n.__maxScrollTop:0>s&&(s=0),n.__publish(a,s,e,t)},zoomBy:function(e,t,i,r,o){var n=this;n.zoomTo(n.__zoomLevel*e,t,i,r,o)},scrollTo:function(e,t,i,r){var o=this;if(o.__isDecelerating&&(core.effect.Animate.stop(o.__isDecelerating),o.__isDecelerating=!1),null!=r&&r!==o.__zoomLevel){if(!o.options.zooming)throw new Error("Zooming is not enabled!");e*=r,t*=r,o.__computeScrollMax(r)}else r=o.__zoomLevel;o.options.scrollingX?o.options.paging?e=Math.round(e/o.__clientWidth)*o.__clientWidth:o.options.snapping&&(e=Math.round(e/o.__snapWidth)*o.__snapWidth):e=o.__scrollLeft,o.options.scrollingY?o.options.paging?t=Math.round(t/o.__clientHeight)*o.__clientHeight:o.options.snapping&&(t=Math.round(t/o.__snapHeight)*o.__snapHeight):t=o.__scrollTop,e=Math.max(Math.min(o.__maxScrollLeft,e),0),t=Math.max(Math.min(o.__maxScrollTop,t),0),e===o.__scrollLeft&&t===o.__scrollTop&&(i=!1),o.__publish(e,t,r,i)},scrollBy:function(e,t,i){var r=this,o=r.__isAnimating?r.__scheduledLeft:r.__scrollLeft,n=r.__isAnimating?r.__scheduledTop:r.__scrollTop;r.scrollTo(o+(e||0),n+(t||0),i)},doMouseZoom:function(e,t,i,r){var o=this,n=e>0?.97:1.03;return o.zoomTo(o.__zoomLevel*n,!1,i-o.__clientLeft,r-o.__clientTop)},doTouchStart:function(e,t){if(null==e.length)throw new Error("Invalid touch list: "+e);if(t instanceof Date&&(t=t.valueOf()),"number"!=typeof t)throw new Error("Invalid timestamp value: "+t);var i=this;i.__interruptedAnimation=!0,i.__isDecelerating&&(core.effect.Animate.stop(i.__isDecelerating),i.__isDecelerating=!1,i.__interruptedAnimation=!0),i.__isAnimating&&(core.effect.Animate.stop(i.__isAnimating),i.__isAnimating=!1,i.__interruptedAnimation=!0);var r,o,n=1===e.length;n?(r=e[0].pageX,o=e[0].pageY):(r=Math.abs(e[0].pageX+e[1].pageX)/2,o=Math.abs(e[0].pageY+e[1].pageY)/2),i.__initialTouchLeft=r,i.__initialTouchTop=o,i.__zoomLevelStart=i.__zoomLevel,i.__lastTouchLeft=r,i.__lastTouchTop=o,i.__lastTouchMove=t,i.__lastScale=1,i.__enableScrollX=!n&&i.options.scrollingX,i.__enableScrollY=!n&&i.options.scrollingY,i.__isTracking=!0,i.__didDecelerationComplete=!1,i.__isDragging=!n,i.__isSingleTouch=n,i.__positions=[]},doTouchMove:function(e,t,i){if(null==e.length)throw new Error("Invalid touch list: "+e);if(t instanceof Date&&(t=t.valueOf()),"number"!=typeof t)throw new Error("Invalid timestamp value: "+t);var r=this;if(r.__isTracking){var o,n;2===e.length?(o=Math.abs(e[0].pageX+e[1].pageX)/2,n=Math.abs(e[0].pageY+e[1].pageY)/2):(o=e[0].pageX,n=e[0].pageY);var l=r.__positions;if(r.__isDragging){var a=o-r.__lastTouchLeft,s=n-r.__lastTouchTop,c=r.__scrollLeft,_=r.__scrollTop,u=r.__zoomLevel;if(null!=i&&r.options.zooming){var h=u;if(u=u/r.__lastScale*i,u=Math.max(Math.min(u,r.options.maxZoom),r.options.minZoom),h!==u){var f=o-r.__clientLeft,p=n-r.__clientTop;c=(f+c)*u/h-f,_=(p+_)*u/h-p,r.__computeScrollMax(u)}}if(r.__enableScrollX){c-=a*this.options.speedMultiplier;var m=r.__maxScrollLeft;(c>m||0>c)&&(r.options.bouncing?c+=a/2*this.options.speedMultiplier:c=c>m?m:0)}if(r.__enableScrollY){_-=s*this.options.speedMultiplier;var g=r.__maxScrollTop;(_>g||0>_)&&(r.options.bouncing?(_+=s/2*this.options.speedMultiplier,r.__enableScrollX||null==r.__refreshHeight||(!r.__refreshActive&&_<=-r.__refreshHeight?(r.__refreshActive=!0,r.__refreshActivate&&r.__refreshActivate()):r.__refreshActive&&_>-r.__refreshHeight&&(r.__refreshActive=!1,r.__refreshDeactivate&&r.__refreshDeactivate()))):_=_>g?g:0)}l.length>60&&l.splice(0,30),l.push(c,_,t),r.__publish(c,_,u)}else{var d=r.options.locking?3:0,v=5,T=Math.abs(o-r.__initialTouchLeft),S=Math.abs(n-r.__initialTouchTop);r.__enableScrollX=r.options.scrollingX&&T>=d,r.__enableScrollY=r.options.scrollingY&&S>=d,l.push(r.__scrollLeft,r.__scrollTop,t),r.__isDragging=(r.__enableScrollX||r.__enableScrollY)&&(T>=v||S>=v),r.__isDragging&&(r.__interruptedAnimation=!1)}r.__lastTouchLeft=o,r.__lastTouchTop=n,r.__lastTouchMove=t,r.__lastScale=i}},doTouchEnd:function(e){if(e instanceof Date&&(e=e.valueOf()),"number"!=typeof e)throw new Error("Invalid timestamp value: "+e);var t=this;if(t.__isTracking){if(t.__isTracking=!1,t.__isDragging)if(t.__isDragging=!1,t.__isSingleTouch&&t.options.animating&&e-t.__lastTouchMove<=100){for(var i=t.__positions,r=i.length-1,o=r,n=r;n>0&&i[n]>t.__lastTouchMove-100;n-=3)o=n;if(o!==r){var l=i[r]-i[o],a=t.__scrollLeft-i[o-2],s=t.__scrollTop-i[o-1];t.__decelerationVelocityX=a/l*(1e3/60),t.__decelerationVelocityY=s/l*(1e3/60);var c=t.options.paging||t.options.snapping?4:1;(Math.abs(t.__decelerationVelocityX)>c||Math.abs(t.__decelerationVelocityY)>c)&&(t.__refreshActive||t.__startDeceleration(e))}else t.options.scrollingComplete()}else e-t.__lastTouchMove>100&&t.options.scrollingComplete();t.__isDecelerating||(t.__refreshActive&&t.__refreshStart?(t.__publish(t.__scrollLeft,-t.__refreshHeight,t.__zoomLevel,!0),t.__refreshStart&&t.__refreshStart()):((t.__interruptedAnimation||t.__isDragging)&&t.options.scrollingComplete(),t.scrollTo(t.__scrollLeft,t.__scrollTop,!0,t.__zoomLevel),t.__refreshActive&&(t.__refreshActive=!1,t.__refreshDeactivate&&t.__refreshDeactivate()))),t.__positions.length=0}},__publish:function(e,i,o,n){var l=this,a=l.__isAnimating;if(a&&(core.effect.Animate.stop(a),l.__isAnimating=!1),n&&l.options.animating){l.__scheduledLeft=e,l.__scheduledTop=i,l.__scheduledZoom=o;var s=l.__scrollLeft,c=l.__scrollTop,_=l.__zoomLevel,u=e-s,h=i-c,f=o-_,p=function(e,t,i){i&&(l.__scrollLeft=s+u*e,l.__scrollTop=c+h*e,l.__zoomLevel=_+f*e,l.__callback&&l.__callback(l.__scrollLeft,l.__scrollTop,l.__zoomLevel))},m=function(e){return l.__isAnimating===e},g=function(e,t,i){t===l.__isAnimating&&(l.__isAnimating=!1),(l.__didDecelerationComplete||i)&&l.options.scrollingComplete(),l.options.zooming&&(l.__computeScrollMax(),l.__zoomComplete&&(l.__zoomComplete(),l.__zoomComplete=null))};l.__isAnimating=core.effect.Animate.start(p,m,g,l.options.animationDuration,a?t:r)}else l.__scheduledLeft=l.__scrollLeft=e,l.__scheduledTop=l.__scrollTop=i,l.__scheduledZoom=l.__zoomLevel=o,l.__callback&&l.__callback(e,i,o),l.options.zooming&&(l.__computeScrollMax(),l.__zoomComplete&&(l.__zoomComplete(),l.__zoomComplete=null))},__computeScrollMax:function(e){var t=this;null==e&&(e=t.__zoomLevel),t.__maxScrollLeft=Math.max(t.__contentWidth*e-t.__clientWidth,0),t.__maxScrollTop=Math.max(t.__contentHeight*e-t.__clientHeight,0)},__startDeceleration:function(e){var t=this;if(t.options.paging){var i=Math.max(Math.min(t.__scrollLeft,t.__maxScrollLeft),0),r=Math.max(Math.min(t.__scrollTop,t.__maxScrollTop),0),o=t.__clientWidth,n=t.__clientHeight;t.__minDecelerationScrollLeft=Math.floor(i/o)*o,t.__minDecelerationScrollTop=Math.floor(r/n)*n,t.__maxDecelerationScrollLeft=Math.ceil(i/o)*o,t.__maxDecelerationScrollTop=Math.ceil(r/n)*n}else t.__minDecelerationScrollLeft=0,t.__minDecelerationScrollTop=0,t.__maxDecelerationScrollLeft=t.__maxScrollLeft,t.__maxDecelerationScrollTop=t.__maxScrollTop;var l=function(e,i,r){t.__stepThroughDeceleration(r)},a=t.options.snapping?4:.1,s=function(){var e=Math.abs(t.__decelerationVelocityX)>=a||Math.abs(t.__decelerationVelocityY)>=a;return e||(t.__didDecelerationComplete=!0),e},c=function(e,i,r){t.__isDecelerating=!1,t.__didDecelerationComplete&&t.options.scrollingComplete(),t.scrollTo(t.__scrollLeft,t.__scrollTop,t.options.snapping)};t.__isDecelerating=core.effect.Animate.start(l,s,c)},__stepThroughDeceleration:function(e){var t=this,i=t.__scrollLeft+t.__decelerationVelocityX,r=t.__scrollTop+t.__decelerationVelocityY;if(!t.options.bouncing){var o=Math.max(Math.min(t.__maxDecelerationScrollLeft,i),t.__minDecelerationScrollLeft);o!==i&&(i=o,t.__decelerationVelocityX=0);var n=Math.max(Math.min(t.__maxDecelerationScrollTop,r),t.__minDecelerationScrollTop);n!==r&&(r=n,t.__decelerationVelocityY=0)}if(e?t.__publish(i,r,t.__zoomLevel):(t.__scrollLeft=i,t.__scrollTop=r),!t.options.paging){var l=.95;t.__decelerationVelocityX*=l,t.__decelerationVelocityY*=l}if(t.options.bouncing){var a=0,s=0,c=t.options.penetrationDeceleration,_=t.options.penetrationAcceleration;i<t.__minDecelerationScrollLeft?a=t.__minDecelerationScrollLeft-i:i>t.__maxDecelerationScrollLeft&&(a=t.__maxDecelerationScrollLeft-i),r<t.__minDecelerationScrollTop?s=t.__minDecelerationScrollTop-r:r>t.__maxDecelerationScrollTop&&(s=t.__maxDecelerationScrollTop-r),0!==a&&(a*t.__decelerationVelocityX<=0?t.__decelerationVelocityX+=a*c:t.__decelerationVelocityX=a*_),0!==s&&(s*t.__decelerationVelocityY<=0?t.__decelerationVelocityY+=s*c:t.__decelerationVelocityY=s*_)}}};for(var n in o)i.prototype[n]=o[n]}(),t=e.exports={Scroller:i}}])});