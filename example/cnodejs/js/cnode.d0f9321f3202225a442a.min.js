define(["jquery","mcoreExt","mcore","moment","markdown-it","hljs"],function(t,n,r,e,i,o){return function(t){function n(e){if(r[e])return r[e].exports;var i=r[e]={exports:{},id:e,loaded:!1};return t[e].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var r={};return n.m=t,n.c=r,n.p="",n(0)}([function(t,n,r){(function(){"use strict";var n,e,i,o;n=r(1),i=r(2),o=r(3),r(5),r(8),e=!1,t.exports=function(t,c){var s;return s=new i.App(n(t)),s.use(o.loader),s.route("/topic/:id",r(15)).route("/user/:userName",r(18)).route("*",r(19)),s.on("runView",function(){return e===!1?(e=!0,n(c).remove()):void 0}),s.run()}}).call(this)},function(n,r){n.exports=t},function(t,r){t.exports=n},function(t,n,r){(function(){"use strict";var n;n=t.exports={loader:r(4)}}).call(this)},function(t,n,r){(function(){"use strict";var n,e;n=r(1),e=n('<div class="loader-wrap">\n    <div class="flower-loader">\n        Loadingâ€¦\n    </div>\n</div>'),e.hide().appendTo("body"),t.exports=function(t,n){return t?n(t):(this.view.on("beforeRender",function(){return e.show()}),this.view.on("tplBeforeUpdate",function(){return e.show()}),this.view.on("render",function(){return e.hide()}),this.view.on("tplUpdate",function(){return e.hide()}),n())}}).call(this)},function(t,n,r){(function(){"use strict";r(6)}).call(this)},function(t,n,r){(function(){"use strict";var t;t=r(7),t.Template.regTag("top-header",{attr:["title","back"],template:function(){return'<div class="bar bar-header bar-royal">\n    <button rv-on-click="back" class="button button-icon icon ion-ios-arrow-thin-left"></button>\n\n    <h1 class="title" rv-text="title | substr 0 13"></h1>\n</div>'},init:function(t,n){return n}})}).call(this)},function(t,n){t.exports=r},function(t,n,r){"use strict";r(9),r(10)},function(t,n,r){(function(){"use strict";var t,n,e;t=r(1),n=r(7),e=window.location.origin,n.Template.regAttr("link-to-blank",n.Template.Attr.subclass({constructor:n.Template.Attr.prototype.constructor,init:function(){return this.$el.on("click","a",function(){var t,n;return t=String(this.href),-1!==t.indexOf("cnodejs.org/topic/")?(n=t.split("cnodejs.org/topic/").pop(),window.location.href="#/topic/"+n,!1):0!==t.indexOf(e)?(window.open(t),!1):void 0})}}))}).call(this)},function(t,n,r){(function(){"use strict";var t,n,e;t=r(1),e=r(7),n=r(11),e.Template.regAttr("user-link",e.Template.Attr.subclass({constructor:e.Template.Attr.prototype.constructor,init:function(){return this.ix=this.$el.attr("data-ix"),this.$el.on("click","a",function(){var n;return n=String(t(this).attr("href")),0===n.indexOf("/user/")?(window.location.href="#"+n,!1):void 0})},update:function(r){var e;return this.replies=JSON.parse(JSON.stringify(r)),e=this,this.$el.find("a").each(function(){var i,o,c,s,u,a;return i=t(this),u=i.text(),c=i.attr("href"),0===u.indexOf("@")&&0===c.indexOf("/user/")?(a=u.replace("@",""),r=e.replies.slice(0,e.ix),r.reverse(),s="",t.each(r,function(t,n){return n.author.loginname===a?(s=n,!1):void 0}),s?(o=t("<blockquote>\n    "+n.markdown(s.content)+"\n</blockquote>"),o.insertBefore(i)):void 0):void 0})}}))}).call(this)},function(t,n,r){(function(){"use strict";var n,e,i,o,c,s,u;s=r(7),u=r(12),n=r(13),o=r(14),o.initHighlightingOnLoad(),e=s.Template,i=function(){var t;return t=[{js:"javascript",jscript:"javascript",html:"xml",htm:"xml",coffee:"coffeescript","coffee-script":"coffeescript",yml:"yaml",pl:"perl",ru:"ruby",rb:"ruby",csharp:"cs"}],function(n,r){var e,i,c,s,u,a,l;if(r=String(r).toLowerCase()||"javascript",t[r]&&(r=t[r]),o.getLanguage(r))try{i=o.highlight(r,n).value}catch(p){e=p,i=o.highlightAuto(n).value}else i=o.highlightAuto(n).value;return u=i.split("\n"),a="",c="",s=1,u[u.length-1]||u.pop(),u.forEach(function(t,n){return a+='<div class="line">'+(n+s)+"</div>",c+='<div class="line">'+t+"</div>"}),l='<figure class="highlight'+(null!=r?r:" "+{lang:""})+'">',l+='<table>\n    <tr>\n        <td class="gutter"><pre>'+a+'</pre></td>\n        <td class="code"><pre>'+c+"</pre></td>\n    </tr>\n</table>",l+="</figure>"}}(),c=new n({html:!1,xhtmlOut:!1,breaks:!0,langPrefix:"hljs ",linkify:!0,typographer:!1,highlight:i}),e.formatters("dateFormat",function(t,n){return null==n&&(n="YYYY-MM-DD"),u(t).format(n)}),e.formatters("fromNow",function(t){return u(t).fromNow()}),e.formatters("markdown",function(t){return c.render(t)}),t.exports={markdown:function(t){return c.render(t)}}}).call(this)},function(t,n){t.exports=e},function(t,n){t.exports=i},function(t,n){t.exports=o},function(t,n,r){(function(){"use strict";var n,e,i;n=r(1),i=r(2),e=r(16),r(11),r(8),t.exports=e.subclass({constructor:e.prototype.constructor,run:function(t){return this.render("cnode/topic.html",{replieEnd:5,topic:this.api.topic(t).then(function(t){return t.data.replies.forEach(function(t,n){return t.ix=n}),t})})},watch:function(){return this.$el.on("scrollend",function(t){return function(){var n,r,e,i;return r=t.get("topic"),n=t.get("replieEnd"),i=n+5,e=Number(r.data.reply_count),i>e&&(i=e),i!==n?t.set("replieEnd",i):void 0}}(this))}}),t.exports.viewName="topic"}).call(this)},function(t,n,r){(function(){"use strict";var n,e;e=r(2),n=r(17),t.exports=e.View.subclass({constructor:e.View.prototype.constructor,beforeInit:function(){return this.api=n}})}).call(this)},function(t,n,r){(function(){"use strict";var n,e;n=r(1),e="https://cnodejs.org/api/v1",t.exports={topics:function(t){return null==t&&(t={}),t=n.extend({mdrender:!1,limit:10},t),n.get(e+"/topics",t)},topic:function(t){return n.get(e+"/topic/"+t,{mdrender:!1})},user:function(t){return n.get(e+"/user/"+t)}}}).call(this)},function(t,n,r){(function(){"use strict";var n;n=r(16),r(11),r(2),t.exports=n.subclass({constructor:n.prototype.constructor,run:function(t){return this.render("cnode/user.html",{user:this.api.user(t)})}}),t.exports.viewName="user"}).call(this)},function(t,n,r){(function(){"use strict";var n,e,i;n=r(1),i=r(2),e=r(16),t.exports=e.subclass({constructor:e.prototype.constructor,run:function(t){return this.context.page=Number(this.context.page||1),this.context.tab=this.context.tab||"",this.nextPage=this.context.page+1,this.prePage=this.context.page-1,this.page=1,this.render("cnode/index.html",{topics:this.getTopics(),loadPageDone:!0})},getTopics:function(){var t,n,r;return t=this.context.page,r=this.context.tab,n=function(n){return function(){return n.api.topics({page:t,tab:r})}}(this),this.memoryCache("index_topics_"+t+"_"+r).has(n)}}),t.exports.viewName="index"}).call(this)}])});